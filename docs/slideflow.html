

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Source &mdash; slideflow 1.9.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Appendix" href="appendix.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="root.html" class="icon icon-home" alt="Documentation Home"> slideflow
          

          
          </a>

          
            
            
              <div class="version">
                1.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipeline.html">Pipeline Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="project.html">Setting up a Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="validation.html">Validation Planning</a></li>
<li class="toctree-l1"><a class="reference internal" href="extract_tiles.html">Tile extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="training.html">Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluation.html">Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="activations.html">Layer activations</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Source</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#slideflowproject">SlideflowProject</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-slideflow.activations">activations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#io-datasets">io.datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-slideflow.io.tfrecords">io.tfrecords</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-slideflow.model">model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-slideflow.slide">slide</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-slideflow.mosaic">mosaic</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-slideflow.statistics">statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-slideflow.util">util</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="root.html">slideflow</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="root.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Source</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/slideflow.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="source">
<h1>Source<a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h1>
<div class="section" id="slideflowproject">
<h2>SlideflowProject<a class="headerlink" href="#slideflowproject" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="slideflow.SlideflowProject">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.</code><code class="sig-name descname">SlideflowProject</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">project_folder</span></em>, <em class="sig-param"><span class="n">num_gpu</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">reverse_select_gpu</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">force_gpu</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">interactive</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="slideflow.SlideflowProject.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">project_folder</span></em>, <em class="sig-param"><span class="n">num_gpu</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">reverse_select_gpu</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">force_gpu</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">interactive</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes project by creating project folder, prompting user for project settings, and project
settings to “settings.json” within the project directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>project_folder</strong> – Project folder</p></li>
<li><p><strong>num_gpu</strong> – Number of available GPUs. Will try to autoselect GPU</p></li>
<li><p><strong>reverse_select_gpu</strong> – Will try to select GPU from available pool in reverse</p></li>
<li><p><strong>force_gpu</strong> – Int, forces GPU selection to the indicated GPU number</p></li>
<li><p><strong>interactive</strong> – Bool, if true, will solicit project information from the user
via text prompts if if the project has not yet been initialized</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.add_dataset">
<code class="sig-name descname">add_dataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">slides</span></em>, <em class="sig-param"><span class="n">roi</span></em>, <em class="sig-param"><span class="n">tiles</span></em>, <em class="sig-param"><span class="n">tfrecords</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.add_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a dataset to the dataset configuration file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Dataset name.</p></li>
<li><p><strong>slides</strong> – Path to directory containing slides.</p></li>
<li><p><strong>roi</strong> – Path to directory containing CSV ROIs.</p></li>
<li><p><strong>tiles</strong> – Path to directory in which to store extracted tiles.</p></li>
<li><p><strong>tfrecords</strong> – Path to directory in which to store TFRecords of extracted tiles.</p></li>
<li><p><strong>path</strong> – (optional) Path to dataset configuration file. If not provided, uses project default.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.associate_slide_names">
<code class="sig-name descname">associate_slide_names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.associate_slide_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Funtion to automatically associate patient names with slide filenames in the annotations file.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.autoselect_gpu">
<code class="sig-name descname">autoselect_gpu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">number_available</span></em>, <em class="sig-param"><span class="n">reverse</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.autoselect_gpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically claims a free GPU and creates a lock file to prevent
other instances of slideflow from using the same GPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number_available</strong> – Total number of GPUs available to select from</p></li>
<li><p><strong>reverse</strong> – Bool, if True, will select GPU from pool in reverse</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.create_blank_annotations_file">
<code class="sig-name descname">create_blank_annotations_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.create_blank_annotations_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an example blank annotations file.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.create_blank_train_config">
<code class="sig-name descname">create_blank_train_config</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.create_blank_train_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a CSV file with the batch training hyperparameter structure.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.create_hyperparameter_sweep">
<code class="sig-name descname">create_hyperparameter_sweep</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tile_px</span></em>, <em class="sig-param"><span class="n">tile_um</span></em>, <em class="sig-param"><span class="n">finetune_epochs</span></em>, <em class="sig-param"><span class="n">toplayer_epochs</span></em>, <em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">pooling</span></em>, <em class="sig-param"><span class="n">loss</span></em>, <em class="sig-param"><span class="n">learning_rate</span></em>, <em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">hidden_layers</span></em>, <em class="sig-param"><span class="n">optimizer</span></em>, <em class="sig-param"><span class="n">early_stop</span></em>, <em class="sig-param"><span class="n">early_stop_patience</span></em>, <em class="sig-param"><span class="n">early_stop_method</span></em>, <em class="sig-param"><span class="n">balanced_training</span></em>, <em class="sig-param"><span class="n">balanced_validation</span></em>, <em class="sig-param"><span class="n">augment</span></em>, <em class="sig-param"><span class="n">hidden_layer_width</span></em>, <em class="sig-param"><span class="n">trainable_layers</span></em>, <em class="sig-param"><span class="n">L2_weight</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.create_hyperparameter_sweep" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares a hyperparameter sweep, saving to a batch train TSV file.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.create_project">
<code class="sig-name descname">create_project</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">project_folder</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.create_project" title="Permalink to this definition">¶</a></dt>
<dd><p>Prompts user to provide all relevant project configuration and saves configuration to “settings.json”.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">outcome_header</span></em>, <em class="sig-param"><span class="n">hyperparameters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">checkpoint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eval_k_fold</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_tiles_per_slide</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">min_tiles_per_slide</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates a saved model on a given set of tfrecords.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Path to .h5 model to evaluate.</p></li>
<li><p><strong>outcome_header</strong> – Annotation column header that specifies the outcome label.</p></li>
<li><p><strong>hyperparameters</strong> – Path to model’s hyperparameters.json file. If None, searches for this file in the same directory as the model.</p></li>
<li><p><strong>filters</strong> – Filters to use when selecting tfrecords on which to perform evaluation.</p></li>
<li><p><strong>checkpoint</strong> – Path to cp.ckpt file to load, if evaluating a saved checkpoint.</p></li>
<li><p><strong>eval_k_fold</strong> – K-fold iteration number to evaluate. If None, will evaluate all tfrecords irrespective of K-fold.</p></li>
<li><p><strong>max_tiles_per_slide</strong> – Will only use up to this many tiles from each slide for evaluation. If zero, will include all tiles.</p></li>
<li><p><strong>min_tiles_per_slide</strong> – Minimum number of tiles a slide must have to be included in evaluation. Default is 0, but
for best slide-level AUC, a minimum of at least 10 tiles per slide is recommended.</p></li>
<li><p><strong>normalizer</strong> – Normalization strategy to use on image tiles.</p></li>
<li><p><strong>normalizer_source</strong> – Path to normalizer source image.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.extract_dual_tiles">
<code class="sig-name descname">extract_dual_tiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tile_um</span></em>, <em class="sig-param"><span class="n">tile_px</span></em>, <em class="sig-param"><span class="n">stride_div</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.extract_dual_tiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Experimental function to extract dual tiles at two different px/um sizes, saving both within the same TFRecord.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.extract_tiles">
<code class="sig-name descname">extract_tiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tile_px</span></em>, <em class="sig-param"><span class="n">tile_um</span></em>, <em class="sig-param"><span class="n">filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filter_blank</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">stride_div</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">tma</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_tiles</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_tfrecord</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">enable_downsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">roi_method</span><span class="o">=</span><span class="default_value">'inside'</span></em>, <em class="sig-param"><span class="n">skip_missing_roi</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">skip_extracted</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">dataset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">whitespace_fraction</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">whitespace_threshold</span><span class="o">=</span><span class="default_value">230</span></em>, <em class="sig-param"><span class="n">grayspace_fraction</span><span class="o">=</span><span class="default_value">0.6</span></em>, <em class="sig-param"><span class="n">grayspace_threshold</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_threads</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.extract_tiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract tiles from a group of slides; save a percentage of tiles for validation testing if the
validation target is ‘per-patient’; and generate TFRecord files from the raw images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile_px</strong> – Tile size in pixels.</p></li>
<li><p><strong>tile_um</strong> – Tile size in microns.</p></li>
<li><p><strong>filters</strong> – Dataset filters to use when selecting slides for tile extraction.</p></li>
<li><p><strong>stride_div</strong> – Stride divisor to use when extracting tiles. A stride of 1 will extract non-overlapping tiles.
A stride_div of 2 will extract overlapping tiles, with a stride equal to 50% of the tile width.</p></li>
<li><p><strong>tma</strong> – Bool. If True, reads slides as Tumor Micro-Arrays (TMAs), detecting and extracting tumor cores.</p></li>
<li><p><strong>save_tiles</strong> – Bool. If True, will save JPEG images of extracted tiles to corresponding tile directory.</p></li>
<li><p><strong>save_tfrecord</strong> – Bool. If True, will save JPEG-compressed image data from extracted tiles into TFRecords in the corresponding TFRecord directory.</p></li>
<li><p><strong>enable_downsample</strong> – Bool. If True, enables the use of downsampling while reading slide images. This may result in corrupted image tiles
if downsampled slide layers are corrupted or not fully generated. Manual confirmation of tile integrity is recommended.</p></li>
<li><p><strong>roi_method</strong> – Either ‘inside’, ‘outside’, or ‘ignore’. Whether to extract tiles inside or outside the ROIs.</p></li>
<li><p><strong>skip_missing_roi</strong> – Bool. If True, will skip slides that are missing ROIs</p></li>
<li><p><strong>skip_extracted</strong> – Bool. If True, will skip slides that have already been fully extracted</p></li>
<li><p><strong>dataset</strong> – Name of dataset from which to select slides for extraction. If not provided, will default to all datasets in project</p></li>
<li><p><strong>normalizer</strong> – Normalization strategy to use on image tiles</p></li>
<li><p><strong>normalizer_source</strong> – Path to normalizer source image</p></li>
<li><p><strong>whitespace_fraction</strong> – Float 0-1. Fraction of whitespace which causes a tile to be discarded. If 1, will not perform whitespace filtering.</p></li>
<li><p><strong>whitespace_threshold</strong> – Int 0-255. Threshold above which a pixel (averaged across R,G,B) is considered whitespace.</p></li>
<li><p><strong>grayspace_fraction</strong> – Float 0-1. Fraction of grayspace which causes a tile to be discarded. If 1, will not perform grayspace filtering.</p></li>
<li><p><strong>grayspace_threshold</strong> – Int 0-1. HSV (hue, saturation, value) is calculated for each pixel. If a pixel’s saturation is below this threshold, it is considered grayspace.</p></li>
<li><p><strong>buffer</strong> – Either ‘vmtouch’ or path to directory. If vmtouch, will use vmtouch to preload slide into memory before extraction.
If a directory, slides will be copied to the directory as a buffer before extraction.
Either method vastly improves tile extraction for slides on HDDs by maximizing sequential read speed</p></li>
<li><p><strong>num_threads</strong> – Number of threads to use during tile extraction. If -1 (default), will use project default thread count.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.extract_tiles_from_tfrecords">
<code class="sig-name descname">extract_tiles_from_tfrecords</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tile_px</span></em>, <em class="sig-param"><span class="n">tile_um</span></em>, <em class="sig-param"><span class="n">destination</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filters</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.extract_tiles_from_tfrecords" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts all tiles from a set of TFRecords.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile_px</strong> – Tile size in pixels</p></li>
<li><p><strong>tile_um</strong> – Tile size in microns</p></li>
<li><p><strong>destination</strong> – Destination folder in which to save tile images</p></li>
<li><p><strong>filters</strong> – Dataset filters to use when selecting TFRecords</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.generate_activations_analytics">
<code class="sig-name descname">generate_activations_analytics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">outcome_header</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filter_blank</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">focus_nodes</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">node_exclusion</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">activations_export</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">activations_cache</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_tiles_per_slide</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">model_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.generate_activations_analytics" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates final layer activations and displays information regarding the most significant final layer nodes.
Note: GPU memory will remain in use, as the Keras model associated with the visualizer is active.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Path to .h5 model</p></li>
<li><p><strong>outcome_header</strong> – Column header in annotations file; used for category-level comparisons</p></li>
<li><p><strong>filters</strong> – Dataset filters for selecting TFRecords</p></li>
<li><p><strong>filter_blank</strong> – List of outcome headers; slides that have blank entries in this outcome header
in the annotations file will be excluded</p></li>
<li><p><strong>focus_nodes</strong> – List of int, indicates which nodes are of interest for subsequent analysis</p></li>
<li><p><strong>node_exclusion</strong> – int, if provided, will excude this node from analyses</p></li>
<li><p><strong>activations_export</strong> – Path to CSV file, if provided, will save activations in CSV format to this file</p></li>
<li><p><strong>activations_cache</strong> – Either ‘default’ or path to ‘PKL’ file; will save activations to this file in PKL format as cache</p></li>
<li><p><strong>normalizer</strong> – Normalization strategy to use on image tiles</p></li>
<li><p><strong>normalizer_source</strong> – Path to normalizer source image</p></li>
<li><p><strong>model_format</strong> – Optional. May supply format of saved Slideflow Keras model if the model was made with a legacy version.
Default value will be slideflow.model.MODEL_FORMAT_CURRENT,
but slideflow.model.MODEL_FORMAT_LEGACY may be supplied.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.generate_heatmaps">
<code class="sig-name descname">generate_heatmaps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filter_blank</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">directory</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">resolution</span><span class="o">=</span><span class="default_value">'low'</span></em>, <em class="sig-param"><span class="n">interpolation</span><span class="o">=</span><span class="default_value">'none'</span></em>, <em class="sig-param"><span class="n">show_roi</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">logit_cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">skip_thumb</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">single_thread</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">model_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.generate_heatmaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates predictive heatmap overlays on a set of slides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Path to .h5 model with which predictions will be generated.</p></li>
<li><p><strong>filters</strong> – Dataset filters to use when selecting slides for which to generate heatmaps.</p></li>
<li><p><strong>filter_blank</strong> – List of outcome headers; slides that have blank entries in this outcome header
in the annotations file will be excluded</p></li>
<li><p><strong>directory</strong> – Directory in which to save heatmap images.</p></li>
<li><p><strong>resolution</strong> – Heatmap resolution (determines stride of tile predictions).
“low” uses a stride equal to tile width.
“medium” uses a stride equal 1/2 tile width.
“high” uses a stride equal to 1/4 tile width.</p></li>
<li><p><strong>interpolation</strong> – Interpolation strategy for smoothing heatmap predictions (matplotlib imshow interpolation options).</p></li>
<li><p><strong>show_roi</strong> – Bool. If True, will show ROI on heatmaps.</p></li>
<li><p><strong>logit_cmap</strong> – <p>Either a function or a dictionary used to create heatmap colormap.
If None (default), separate heatmaps will be generated for each outcome category, with color representing likelihood of category prediction.
Each image tile will generate a list of predictions of length O,
where O is the number of outcome categories.
If logit_cmap is a function, then this logit prediction list will be passed to the function,
and the function is expected to return [R, G, B] values which will be displayed. single_thread must be true if a function is passed.
If the logit_cmap is a dictionary, it should map ‘r’, ‘g’, and ‘b’ to outcome indices;
The prediction for these outcome categories will be mapped to the corresponding colors.
Thus, the corresponding color will only reflect predictions of up to three outcome categories.</p>
<blockquote>
<div><p>Example (this would map prediction for outcome 0 to the red colorspace, outcome 3 to green colorspace, etc):
{‘r’: 0, ‘g’: 3, ‘b’: 1 }</p>
</div></blockquote>
</p></li>
<li><p><strong>skip_thumb</strong> – Bool. If True, will not display thumbnail with heatmap.</p></li>
<li><p><strong>normalizer</strong> – Normalization strategy to use on image tiles</p></li>
<li><p><strong>normalizer_source</strong> – Path to normalizer source image</p></li>
<li><p><strong>buffer</strong> – Either ‘vmtouch’ or path to directory. If vmtouch, will use vmtouch to preload slide into memory before extraction.
If a directory, slides will be copied to the directory as a buffer before extraction.
Either method vastly improves tile extraction for slides on HDDs by maximizing sequential read speed</p></li>
<li><p><strong>single_thread</strong> – Bool. If True, will perform as single thread (GPU memory may not be freed after completion).
Allows use for functions being passed to logit_cmap (functions are not pickleable).
If False, will wrap function in separate process, allowing GPU memory to be freed after completion.</p></li>
<li><p><strong>model_format</strong> – Optional. May supply format of saved Slideflow Keras model if the model was made with a legacy version.
Default value will be slideflow.model.MODEL_FORMAT_CURRENT,
but slideflow.model.MODEL_FORMAT_LEGACY may be supplied.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.generate_mosaic">
<code class="sig-name descname">generate_mosaic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">mosaic_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">umap_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outcome_header</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filter_blank</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">focus_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">resolution</span><span class="o">=</span><span class="default_value">'low'</span></em>, <em class="sig-param"><span class="n">num_tiles_x</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">max_tiles_per_slide</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">expanded</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">map_slide</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">show_prediction</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">restrict_prediction</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">predict_on_axes</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">whitespace_on_axes</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">outcome_labels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">umap_cache</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">activations_cache</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">activations_export</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">umap_export</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_float</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">low_memory</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">model_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.generate_mosaic" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Generates a mosaic map by overlaying images onto a set of mapped tiles.</dt><dd><p>Image tiles are extracted from the provided set of TFRecords, and predictions + penultimate node activations are calculated using the specified model.
Tiles are mapped either with dimensionality reduction on penultimate layer activations (default behavior),
or by using outcome predictions for two categories, mapped to X- and Y-axis (via predict_on_axes).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Path to .h5 file to use when generating layer activations.</p></li>
<li><p><strong>mosaic_filename</strong> – Filename for mosaic image. If not provided, mosaic will not be calculated or saved. Will be saved in project mosaic directory.</p></li>
<li><p><strong>umap_filename</strong> – Filename for UMAP plot image. If not provided, plot will not be saved. Will be saved in project stats directory.</p></li>
<li><p><strong>outcome_header</strong> – Column name in annotations file from which to read category labels.</p></li>
<li><p><strong>filters</strong> – Dataset filters to use when selecting slides to include the mosaic.</p></li>
<li><p><strong>filter_blank</strong> – List of outcome headers; slides that have blank entries in this outcome header
in the annotations file will be excluded</p></li>
<li><p><strong>focus_filters</strong> – Dataset filters to use when selecting slides to highlight on the mosaic.</p></li>
<li><p><strong>resolution</strong> – Resolution of the mosaic map. Impacts size of the final figure. Either low, medium, or high.</p></li>
<li><p><strong>num_tiles_x</strong> – Specifies the size of the mosaic map grid.</p></li>
<li><p><strong>max_tiles_per_slide</strong> – Limits the number of tiles taken from each slide. Too high of a number may introduce memory issues.</p></li>
<li><p><strong>expanded</strong> – Bool. If False, will limit tile assignment to the corresponding grid space (strict display).
If True, allows for display of nearby tiles if a given grid is empty.</p></li>
<li><p><strong>map_slide</strong> – None (default), ‘centroid’, or ‘average’. If provided, will map slides using slide-level calculations, either mapping centroid tiles if ‘centroid’,
or calculating node averages across all tiles in a slide and mapping slide-level node averages, if ‘average’</p></li>
<li><p><strong>show_prediction</strong> – May be either int or string, corresponding to outcome category. Predictions for this category will be displayed
On the exported UMAP plot.</p></li>
<li><p><strong>restrict_prediction</strong> – List of int, if provided, will restrict predictions to only these categories
(final tile-level prediction is made by choosing category with highest logit)</p></li>
<li><p><strong>predict_on_axes</strong> – (int, int). Each int corresponds to an outcome category id.
If provided, predictions are generated for these two outcomes;
tiles are then mapped with these predictions with the pattern (x, y)
and the mosaic is generated from this map. This replaces the default
dimensionality reduction mapping.</p></li>
<li><p><strong>outcome_labels</strong> – Dict mapping outcome id (int) to string labels</p></li>
<li><p><strong>cmap</strong> – Colormap mapping outcomes to colors for display on UMAP plot</p></li>
<li><p><strong>model_type</strong> – Either ‘categorical’ or ‘linear’</p></li>
<li><p><strong>umap_cache</strong> – Either ‘default’ or path to PKL file in which to save/cache UMAP coordinates</p></li>
<li><p><strong>activations_cache</strong> – Either ‘default’ or path to PKL file in which to save/cache nodal activations</p></li>
<li><p><strong>activations_export</strong> – Filename for CSV export of activations. Will be saved in project stats directory.</p></li>
<li><p><strong>umap_export</strong> – Filename for CSV export of UMAP coordinates. Will be saved in project stats directory.</p></li>
<li><p><strong>use_float</strong> – Bool, if True, assumes outcome values are float / linear (as opposed to category labels)</p></li>
<li><p><strong>normalizer</strong> – Normalization strategy to use on image tiles</p></li>
<li><p><strong>normalizer_source</strong> – Path to normalizer source image</p></li>
<li><p><strong>low_memory</strong> – Bool, if True, will attempt to limit memory during UMAP calculations at the cost of increased computational complexity</p></li>
<li><p><strong>model_format</strong> – Optional. May supply format of saved Slideflow Keras model if the model was made with a legacy version.
Default value will be slideflow.model.MODEL_FORMAT_CURRENT,
but slideflow.model.MODEL_FORMAT_LEGACY may be supplied.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.generate_mosaic_from_annotations">
<code class="sig-name descname">generate_mosaic_from_annotations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">header_x</span></em>, <em class="sig-param"><span class="n">header_y</span></em>, <em class="sig-param"><span class="n">tile_px</span></em>, <em class="sig-param"><span class="n">tile_um</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mosaic_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">umap_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outcome_header</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">focus_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">resolution</span><span class="o">=</span><span class="default_value">'low'</span></em>, <em class="sig-param"><span class="n">num_tiles_x</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">max_tiles_per_slide</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">expanded</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">use_optimal_tile</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">activations_cache</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.generate_mosaic_from_annotations" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Generates a mosaic map by overlaying images onto a set of mapped tiles.</dt><dd><p>Slides are mapped using slide-level annotations, with x-axis value determined from header_x, and y-axis from header_y.
If use_optimal_tile is False and no model is provided, the first image tile in a slide’s TFRecord is used for display.
If optimal_tile is True, penultimate layer activations for all tiles in each slide are calculated using the provided model,
and the tile nearest to centroid is used for display.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header_x</strong> – Column name in annotations file from which to read X-axis coordinates.</p></li>
<li><p><strong>header_y</strong> – Column name in annotations file from which to read Y-axis coordinates.</p></li>
<li><p><strong>tile_px</strong> – Tile size in pixels.</p></li>
<li><p><strong>tile_um</strong> – Tile size in microns.</p></li>
<li><p><strong>model</strong> – Path to .h5 file to use when generating layer activations.</p></li>
<li><p><strong>mosaic_filename</strong> – Filename for mosaic image. If not provided, mosaic will not be calculated or saved. Will be saved in project mosaic directory.</p></li>
<li><p><strong>umap_filename</strong> – Filename for UMAP plot image. If not provided, plot will not be saved. Will be saved in project stats directory.</p></li>
<li><p><strong>outcome_header</strong> – Column name in annotations file from which to read category labels.</p></li>
<li><p><strong>filters</strong> – Dataset filters to use when selecting slides to include the mosaic.</p></li>
<li><p><strong>focus_filters</strong> – Dataset filters to use when selecting slides to highlight on the mosaic.</p></li>
<li><p><strong>resolution</strong> – Resolution of the mosaic map. Impacts size of the final figure. Either low, medium, or high.</p></li>
<li><p><strong>num_tiles_x</strong> – Specifies the size of the mosaic map grid.</p></li>
<li><p><strong>max_tiles_per_slide</strong> – Limits the number of tiles taken from each slide. Too high of a number may introduce memory issues.</p></li>
<li><p><strong>expanded</strong> – Bool. If False, will limit tile assignment to the corresponding grid space (strict display).
If True, allows for display of nearby tiles if a given grid is empty.</p></li>
<li><p><strong>use_optimal_tile</strong> – Bool. If True, will use model to create penultimate layer activations for all tiles in each slide,
and choosing tile nearest to centroid for each slide for display.</p></li>
<li><p><strong>activations_cache</strong> – Either ‘default’ or path to PKL file in which to save/cache nodal activations</p></li>
<li><p><strong>normalizer</strong> – Normalization strategy to use on image tiles</p></li>
<li><p><strong>normalizer_source</strong> – Path to normalizer source image</p></li>
<li><p><strong>model_format</strong> – Optional. May supply format of saved Slideflow Keras model if the model was made with a legacy version.
Default value will be slideflow.model.MODEL_FORMAT_CURRENT,
but slideflow.model.MODEL_FORMAT_LEGACY may be supplied.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.generate_tfrecords_from_tiles">
<code class="sig-name descname">generate_tfrecords_from_tiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tile_px</span></em>, <em class="sig-param"><span class="n">tile_um</span></em>, <em class="sig-param"><span class="n">delete_tiles</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.generate_tfrecords_from_tiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Create tfrecord files from a collection of raw images, as stored in project tiles directory</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.generate_thumbnails">
<code class="sig-name descname">generate_thumbnails</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">size</span><span class="o">=</span><span class="default_value">512</span></em>, <em class="sig-param"><span class="n">filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filter_blank</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">roi</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">enable_downsample</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.generate_thumbnails" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates square slide thumbnails with black box borders of a fixed size, and saves to project folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> – Int. Width/height of thumbnail in pixels.</p></li>
<li><p><strong>filters</strong> – Dataset filters.</p></li>
<li><p><strong>filter_blank</strong> – Header columns in annotations by which to filter slides, if the slides are blank in this column.</p></li>
<li><p><strong>enable_downsample</strong> – Bool. If True and a thumbnail is not embedded in the slide file, downsampling is permitted in order
to accelerate thumbnail calculation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.get_dataset">
<code class="sig-name descname">get_dataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tile_px</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tile_um</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filter_blank</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verification</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.get_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns slideflow.io.Dataset object using project settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile_px</strong> – Tile size in pixels</p></li>
<li><p><strong>tile_um</strong> – Tile size in microns</p></li>
<li><p><strong>filters</strong> – Dictionary of annotations filters to use when selecting slides/TFRecords to include in dataset</p></li>
<li><p><strong>filter_blank</strong> – List of outcome headers; will only include slides that are not blank in these outcomes</p></li>
<li><p><strong>verification</strong> – If true, will verify all annotations are mapped to slides and that the TFRecords manifest is updated</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.load_datasets">
<code class="sig-name descname">load_datasets</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.load_datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads datasets dictionaries from a given datasets.json file.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.load_project">
<code class="sig-name descname">load_project</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">directory</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.load_project" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a saved and pre-configured project from the specified directory.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.release_gpu">
<code class="sig-name descname">release_gpu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.release_gpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Releases GPU lock.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.resize_tfrecords">
<code class="sig-name descname">resize_tfrecords</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">source_tile_px</span></em>, <em class="sig-param"><span class="n">source_tile_um</span></em>, <em class="sig-param"><span class="n">dest_tile_px</span></em>, <em class="sig-param"><span class="n">filters</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.resize_tfrecords" title="Permalink to this definition">¶</a></dt>
<dd><p>Resizes images in a set of TFRecords to a given pixel size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_tile_px</strong> – Pixel size of source images. Used to select source TFRecords.</p></li>
<li><p><strong>source_tile_um</strong> – Micron size of source images. Used to select source TFRecords.</p></li>
<li><p><strong>dest_tile_px</strong> – Pixel size of resized images.</p></li>
<li><p><strong>filters</strong> – Dictionary of dataset filters to use for selecting TFRecords for resizing.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.save_project">
<code class="sig-name descname">save_project</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.save_project" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves current project configuration as “settings.json”.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.select_gpu">
<code class="sig-name descname">select_gpu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">number</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.select_gpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets environmental variables such that the indicated GPU is used by CUDA/Tensorflow.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.slide_report">
<code class="sig-name descname">slide_report</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tile_px</span></em>, <em class="sig-param"><span class="n">tile_um</span></em>, <em class="sig-param"><span class="n">filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filter_blank</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dataset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">stride_div</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">destination</span><span class="o">=</span><span class="default_value">'auto'</span></em>, <em class="sig-param"><span class="n">tma</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">enable_downsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">roi_method</span><span class="o">=</span><span class="default_value">'inside'</span></em>, <em class="sig-param"><span class="n">skip_missing_roi</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.slide_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a PDF report of slides, including images of 10 example extracted tiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile_px</strong> – Tile width in pixels</p></li>
<li><p><strong>tile_um</strong> – Tile width in microns</p></li>
<li><p><strong>filters</strong> – Dataset filters to use for selecting TFRecords</p></li>
<li><p><strong>filter_blank</strong> – List of outcome headers; slides that have blank entries in this outcome header
in the annotations file will be excluded</p></li>
<li><p><strong>dataset</strong> – Name of dataset from which to select TFRecords. If not provided, will use all project datasets</p></li>
<li><p><strong>stride_div</strong> – Stride divisor for tile extraction</p></li>
<li><p><strong>destination</strong> – Either ‘auto’ or explicit filename at which to save the PDF report</p></li>
<li><p><strong>tma</strong> – Bool, if True, interprets slides to be TMA (tumor microarrays)</p></li>
<li><p><strong>enable_downsample</strong> – Bool, if True, enables downsampling during tile extraction</p></li>
<li><p><strong>roi_method</strong> – Either ‘inside’, ‘outside’, or ‘ignore’. Determines how ROIs will guide tile extraction</p></li>
<li><p><strong>skip_missing_roi</strong> – Bool, if True, will skip tiles that are missing ROIs</p></li>
<li><p><strong>normalizer</strong> – Normalization strategy to use on image tiles</p></li>
<li><p><strong>normalizer_source</strong> – Path to normalizer source image</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.tfrecord_report">
<code class="sig-name descname">tfrecord_report</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tile_px</span></em>, <em class="sig-param"><span class="n">tile_um</span></em>, <em class="sig-param"><span class="n">filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filter_blank</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dataset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">destination</span><span class="o">=</span><span class="default_value">'auto'</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.tfrecord_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a PDF report of TFRecords, including 10 example tiles per TFRecord.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile_px</strong> – Tile width in pixels</p></li>
<li><p><strong>tile_um</strong> – Tile width in microns</p></li>
<li><p><strong>filters</strong> – Dataset filters to use for selecting TFRecords</p></li>
<li><p><strong>filter_blank</strong> – List of outcome headers; slides that have blank entries in this outcome header
in the annotations file will be excluded</p></li>
<li><p><strong>destination</strong> – Either ‘auto’ or explicit filename at which to save the PDF report</p></li>
<li><p><strong>normalizer</strong> – Normalization strategy to use on image tiles</p></li>
<li><p><strong>normalizer_source</strong> – Path to normalizer source image</p></li>
<li><p><strong>dataset</strong> – Name of dataset from which to select TFRecords. If not provided, will use all project datasets</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">models</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outcome_header</span><span class="o">=</span><span class="default_value">'category'</span></em>, <em class="sig-param"><span class="n">input_header</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">multi_outcome</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">resume_training</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">checkpoint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pretrain</span><span class="o">=</span><span class="default_value">'imagenet'</span></em>, <em class="sig-param"><span class="n">batch_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">hyperparameters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">validation_target</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">validation_strategy</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">validation_fraction</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">validation_k_fold</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">k_fold_iter</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">validation_dataset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">validation_annotations</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">validation_filters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">validate_on_batch</span><span class="o">=</span><span class="default_value">512</span></em>, <em class="sig-param"><span class="n">validation_steps</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">max_tiles_per_slide</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">min_tiles_per_slide</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">starting_epoch</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">auto_extract</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_strategy</span><span class="o">=</span><span class="default_value">'tfrecord'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train model(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>models</strong> – Either a string representing a model name, or an array of strings containing multiple model names.
Required if training to a single hyperparameter combination with the “hyperparameters” argument.
If performing a hyperparameter sweep, will only train models with these names in the batch_train.tsv config file.
May supply None if performing a hyperparameter sweep, in which case all models in the batch_train.tsv config file will be trained.</p></li>
<li><p><strong>outcome_header</strong> – String or list. Specifies which header(s) in the annotation file to use for the output category.
Defaults to ‘category’. If a list is provided, will loop through all outcomes and perform HP sweep on each.</p></li>
<li><p><strong>multi_outcome</strong> – If True, will train to multiple outcomes simultaneously instead of looping through the
list of outcomes in “outcome_header”. Defaults to False.</p></li>
<li><p><strong>filters</strong> – Dictionary of column names mapping to column values by which to filter slides using the annotation file.</p></li>
<li><p><strong>resume_training</strong> – Path to .h5 model to continue training</p></li>
<li><p><strong>checkpoint</strong> – Path to cp.ckpt from which to load weights</p></li>
<li><p><strong>pretrain</strong> – Pretrained weights to load. Default is imagenet. May supply a compatible .h5 file from which to load weights.</p></li>
<li><p><strong>batch_file</strong> – Manually specify batch file to use for a hyperparameter sweep. If not specified, will use project default.</p></li>
<li><p><strong>hyperparameters</strong> – Manually specify hyperparameter combination to use for training. If specified, will ignore batch training file.</p></li>
<li><p><strong>validation_target</strong> – Whether to select validation data on a ‘per-patient’ or ‘per-tile’ basis. If not specified, will use project default.</p></li>
<li><p><strong>validation_strategy</strong> – Validation dataset selection strategy (bootstrap, k-fold, fixed, none). If not specified, will use project default.</p></li>
<li><p><strong>validation_fraction</strong> – Fraction of data to use for validation testing. If not specified, will use project default.</p></li>
<li><p><strong>validation_k_fold</strong> – K, if using k-fold validation. If not specified, will use project default.</p></li>
<li><p><strong>k_fold_iter</strong> – Which iteration to train if using k-fold validation. Defaults to training all iterations.</p></li>
<li><p><strong>validation_dataset</strong> – If specified, will use a separate dataset on which to perform validation.</p></li>
<li><p><strong>validation_annotations</strong> – If using a separate dataset for validation, the annotations CSV must be supplied.</p></li>
<li><p><strong>validation_filters</strong> – If using a separate dataset for validation, these filters are used to select a subset of slides for validation.</p></li>
<li><p><strong>validate_on_batch</strong> – Validation will be performed every X batches.</p></li>
<li><p><strong>validation_steps</strong> – Number of batches to use for each instance of validation</p></li>
<li><p><strong>max_tiles_per_slide</strong> – Will only use up to this many tiles from each slide for training. If zero, will include all tiles.</p></li>
<li><p><strong>min_tiles_per_slide</strong> – Minimum number of tiles a slide must have to be included in training.</p></li>
<li><p><strong>starting_epoch</strong> – Starts training at the specified epoch</p></li>
<li><p><strong>auto_extract</strong> – Bool. If True, will automatically extract tiles as needed for training, without needing to explicitly call extract_tiles()</p></li>
<li><p><strong>normalizer</strong> – Normalization strategy to use on image tiles</p></li>
<li><p><strong>normalizer_source</strong> – Path to normalizer source image</p></li>
<li><p><strong>normalizer_strategy</strong> – Either ‘tfrecord’ or ‘realtime’. If TFrecord and auto_extract is True, then tiles will be extracted to TFRecords and stored normalized.
If realtime, then normalization is performed during training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary containing model names mapped to train_acc, val_loss, and val_acc</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.SlideflowProject.visualize_tiles">
<code class="sig-name descname">visualize_tiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">node</span></em>, <em class="sig-param"><span class="n">tfrecord_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">directory</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mask_width</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.SlideflowProject.visualize_tiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualizes node activations across a set of image tiles through progressive convolutional masking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Path to .h5 model file</p></li>
<li><p><strong>node</strong> – Int, node to analyze</p></li>
<li><p><strong>tfrecord_dict</strong> – Dictionary mapping tfrecord paths to tile indices. Visualization will be performed on these tiles.</p></li>
<li><p><strong>directory</strong> – Directory in which to save images.</p></li>
<li><p><strong>mask_width</strong> – Width of mask to convolutionally apply. Defaults to 1/6 of tile_px</p></li>
<li><p><strong>normalizer</strong> – Normalization strategy to use on image tiles.</p></li>
<li><p><strong>normalizer_source</strong> – Path to normalizer source image.</p></li>
<li><p><strong>model_format</strong> – Optional. May supply format of saved Slideflow Keras model if the model was made with a legacy version.
Default value will be slideflow.model.MODEL_FORMAT_CURRENT,
but slideflow.model.MODEL_FORMAT_LEGACY may be supplied.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-slideflow.activations">
<span id="activations"></span><h2>activations<a class="headerlink" href="#module-slideflow.activations" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt id="slideflow.activations.ActivationsError">
<em class="property">exception </em><code class="sig-prename descclassname">slideflow.activations.</code><code class="sig-name descname">ActivationsError</code><a class="headerlink" href="#slideflow.activations.ActivationsError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="slideflow.activations.ActivationsVisualizer">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.activations.</code><code class="sig-name descname">ActivationsVisualizer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">tfrecords</span></em>, <em class="sig-param"><span class="n">root_dir</span></em>, <em class="sig-param"><span class="n">image_size</span></em>, <em class="sig-param"><span class="n">annotations</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outcome_header</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">focus_nodes</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">use_fp16</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_activations_cache</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">activations_cache</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">32</span></em>, <em class="sig-param"><span class="n">activations_export</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_tiles_per_slide</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">manifest</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads annotations, saved layer activations, and prepares output saving directories.
Will also read/write processed activations to a PKL cache file to save time in future iterations.</p>
<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">tfrecords</span></em>, <em class="sig-param"><span class="n">root_dir</span></em>, <em class="sig-param"><span class="n">image_size</span></em>, <em class="sig-param"><span class="n">annotations</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outcome_header</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">focus_nodes</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">use_fp16</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_activations_cache</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">activations_cache</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">32</span></em>, <em class="sig-param"><span class="n">activations_export</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_tiles_per_slide</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">manifest</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Object initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Path to model from which to calculate activations</p></li>
<li><p><strong>tfrecords</strong> – List of tfrecords paths</p></li>
<li><p><strong>root_dir</strong> – Root directory in which to save cache files and output files</p></li>
<li><p><strong>image_size</strong> – Int, width/height of input images in pixels</p></li>
<li><p><strong>annotations</strong> – Path to CSV file containing slide annotations</p></li>
<li><p><strong>outcome_header</strong> – String, name of outcome header in annotations file, used to compare activations between categories</p></li>
<li><p><strong>focus_nodes</strong> – List of int, nodes on which to focus when generating cross-category statistics</p></li>
<li><p><strong>use_fp16</strong> – Bool, whether to use FP16 (rather than FP32)</p></li>
<li><p><strong>normalizer</strong> – String, which real-time normalization to use on images taken from TFRecords</p></li>
<li><p><strong>noramlizer_source</strong> – String, path to image to use as source for real-time normalization</p></li>
<li><p><strong>use_activations_cache</strong> – Bool, if true, will store activations in a PKL cache file for rapid re-use</p></li>
<li><p><strong>activations_cache</strong> – File in which to store activations PKL cache</p></li>
<li><p><strong>batch_size</strong> – Batch size to use during activations calculations</p></li>
<li><p><strong>activations_export</strong> – Filename for CSV export of activations</p></li>
<li><p><strong>max_tiles_per_slide</strong> – Maximum number of tiles from which to generate activations for each slide</p></li>
<li><p><strong>manifest</strong> – Optional, dict mapping tfrecords to number of tiles contained. Used for progress bars.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.calculate_activation_averages_and_stats">
<code class="sig-name descname">calculate_activation_averages_and_stats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">node_method</span><span class="o">=</span><span class="default_value">'avg'</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.calculate_activation_averages_and_stats" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Calculates activation averages across categories,</dt><dd><p>as well as tile-level and patient-level statistics using ANOVA,
exporting to CSV if desired.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – Path to CSV file for export.</p></li>
<li><p><strong>node_method</strong> – Either ‘avg’ (default) or ‘threshold’. If avg, slide-level node data is calculated by averaging
node activations across all tiles. If threshold, slide-level node data is calculated by counting
the number of tiles with node activations &gt; threshold and dividing by the total number of tiles.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dict mapping slides to dict of nodes mapping to slide-level node values;
Dict mapping nodes to tile-level dict of statistics (‘p’, ‘f’);
Dict mapping nodes to slide-level dict of statistics (‘p’, ‘f’);</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.export_activations_to_csv">
<code class="sig-name descname">export_activations_to_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">nodes</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.export_activations_to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports calculated activations to csv.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – Path to CSV file for export.</p></li>
<li><p><strong>nodes</strong> – (optional) List of int. Activations of these nodes will be exported.
If None, activations for all nodes will be exported.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.find_neighbors">
<code class="sig-name descname">find_neighbors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">neighbor_AV</span></em>, <em class="sig-param"><span class="n">neighbor_slides</span></em>, <em class="sig-param"><span class="n">n_neighbors</span></em>, <em class="sig-param"><span class="n">algorithm</span><span class="o">=</span><span class="default_value">'ball_tree'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.find_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds neighboring tiles for a given ActivationsVisualizer and list of slides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neighbor_AV</strong> – ActivationsVisualizer, will be used to look for neighbors</p></li>
<li><p><strong>neighbor_slides</strong> – Either a single slide name or a list of slide names. Corresponds to slides in the provided neighboring AV.
Will look for neighbors to all tiles in these slides.</p></li>
<li><p><strong>n_neighbors</strong> – Number of neighbors to find for each tile</p></li>
<li><p><strong>algorithm</strong> – NearestNeighbors algorithm, either ‘kd_tree’, ‘ball_tree’, or ‘brute’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dict mapping slide names (from self.slides) to tile indices for tiles that were found to be neighbors to the provided neighbor_AV and neighbor_slides.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.generate_activations_from_model">
<code class="sig-name descname">generate_activations_from_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">tfrecords</span></em>, <em class="sig-param"><span class="n">use_fp16</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">16</span></em>, <em class="sig-param"><span class="n">export</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.generate_activations_from_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates activations from a given model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Path to .h5 file from which to calculate final layer activations.</p></li>
<li><p><strong>use_fp16</strong> – If true, uses Float16 (default) instead of Float32.</p></li>
<li><p><strong>batch_size</strong> – Batch size for model predictions.</p></li>
<li><p><strong>export</strong> – String (default: None). If provided, will export CSV of activations with this filename.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.generate_box_plots">
<code class="sig-name descname">generate_box_plots</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">export_folder</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.generate_box_plots" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates box plots comparing nodal activations at the slide-level and tile-level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>export_folder</strong> – (optional) Path to directory in which to save box plots.
If None, will save boxplots to STATS_ROOT directory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.get_activations">
<code class="sig-name descname">get_activations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.get_activations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns dictionary mapping slides to tile-level node activations.</p>
<dl>
<dt>Example (3 nodes):</dt><dd><dl class="simple">
<dt>{ ‘Slide1’: [[0.1, 0.5, 0.6], # Slide1, node1 activations for all tiles</dt><dd><p>[0.2, 0.1, 0.7], # Slide1, node2 activations for all tiles
[0.4, 0.7, 0.1]] # Slide1, node3 activations for all tiles</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.get_predictions">
<code class="sig-name descname">get_predictions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.get_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns dictionary mapping slides to tile-level logit predictions.</p>
<dl>
<dt>Example (2 outcome categories):</dt><dd><dl class="simple">
<dt>{ ‘Slide1’: [[0.1, 0.9, 0.6], # Slide1, logit predictions for category 1 for all tiles</dt><dd><p>[0.9, 0.1, 0.4], # Slide1, logit predictions for category 2 for all tiles</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.get_slide_level_categorical_predictions">
<code class="sig-name descname">get_slide_level_categorical_predictions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prediction_filter</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.get_slide_level_categorical_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns slide-level predictions assuming the model is predicting a categorical outcome.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prediction_filter</strong> – (optional) List of int. If provided, will restrict predictions to only these
categories, with final prediction being based based on highest logit
among these categories.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Dictionary mapping slide names to final slide-level predictions.
slide_percentages:      This is a dictionary mapping slide names to a dictionary for each category,</p>
<blockquote>
<div><blockquote>
<div><p>which maps the category id to the percent of tiles in the slide
predicted to be this category.
Example:</p>
<blockquote>
<div><dl class="simple">
<dt>{ ‘slide1’: {</dt><dd><p>0: 0.24,
1: 0.15,
2: 0.61 }}</p>
</dd>
</dl>
</div></blockquote>
</div></blockquote>
<p>If linear model, this is the same as slide_predictions.</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>slide_predictions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.get_slide_level_linear_predictions">
<code class="sig-name descname">get_slide_level_linear_predictions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.get_slide_level_linear_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns slide-level predictions assuming the model is predicting a linear outcome.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl>
<dt>Dictionary mapping slide names to final slide-level predictions</dt><dd><p>for each outcome cateogry, calculated as the average predicted value
in the outcome category for all tiles in the slide.
Example:</p>
<blockquote>
<div><dl class="simple">
<dt>{ ‘slide1’: {</dt><dd><p>0: 0.24,        # Outcome category 0
1: 0.15,        # Outcome category 1
2: 0.61 }}      # Outcome category 2</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.get_tile_node_activations_by_category">
<code class="sig-name descname">get_tile_node_activations_by_category</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.get_tile_node_activations_by_category" title="Permalink to this definition">¶</a></dt>
<dd><p>For each outcome category, calculates activations of a given node across all tiles in the category.
Requires annotations to have been loaded with load_annotations()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> – Int, id of node.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>List of node activations separated by category.</dt><dd><p>Example:
[[0.1, 0.2, 0.7, 0.1, 0.0], # Activations for node “N” across all tiles from slides in category 1</p>
<blockquote>
<div><p>[0.8, 0.2, 0.1]]                       # Activations for node “N” across all tiles from slides in category 2</p>
</div></blockquote>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.get_top_nodes_by_slide">
<code class="sig-name descname">get_top_nodes_by_slide</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.get_top_nodes_by_slide" title="Permalink to this definition">¶</a></dt>
<dd><p>First, slide-level average node activations are calculated for all slides.
Then, the significance of the difference in average node activations between for slides
belonging to the different outcome categories is calculated using ANOVA.
This function then returns a list of all nodes, sorted by ANOVA p-value (most significant first).</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.get_top_nodes_by_tile">
<code class="sig-name descname">get_top_nodes_by_tile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.get_top_nodes_by_tile" title="Permalink to this definition">¶</a></dt>
<dd><p>First, tile-level average node activations are calculated for all tiles.
Then, the significance of the difference in node activations for tiles
belonging to the different outcome categories is calculated using ANOVA.
This function then returns a list of all nodes, sorted by ANOVA p-value (most significant first).</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.load_annotations">
<code class="sig-name descname">load_annotations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">annotations</span></em>, <em class="sig-param"><span class="n">outcome_header</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.load_annotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads annotations from a given file with the specified outcome header.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>annotations</strong> – Path to CSV annotations file.</p></li>
<li><p><strong>outcome_header</strong> – String, name of column header from which to read outcome variables.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.logistic_regression">
<code class="sig-name descname">logistic_regression</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">slide_method</span><span class="o">=</span><span class="default_value">'avg'</span></em>, <em class="sig-param"><span class="n">node_threshold</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.logistic_regression" title="Permalink to this definition">¶</a></dt>
<dd><p>Experimental function, creates a logistic regression model to generate slide-level predictions from slide-level statistics.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.map_to_predictions">
<code class="sig-name descname">map_to_predictions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.map_to_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns coordinates and metadata for tile-level predictions for all tiles,
which can be used to create a TFRecordMap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Int, identifies the outcome category id for which predictions will be mapped to the X-axis</p></li>
<li><p><strong>y</strong> – Int, identifies the outcome category id for which predictions will be mapped to the Y-axis</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of x-axis coordinates (predictions for the category ‘x’)
mapped_y:       List of y-axis coordinates (predictions for the category ‘y’)
umap_meta:      List of dictionaries containing tile-level metadata (used for TFRecordMap)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>mapped_x</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.save_example_tiles_gradient">
<code class="sig-name descname">save_example_tiles_gradient</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nodes</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">export_folder</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tile_filter</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.save_example_tiles_gradient" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>For a given set of activation nodes, saves image tiles named according</dt><dd><p>to their corresponding node activations, for easy sorting and visualization.
Duplicate image tiles will be saved for each node, organized into subfolders named according to node id.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nodes</strong> – List of int, nodes to evaluate</p></li>
<li><p><strong>export_folder</strong> – Path to folder in which to save examples tiles</p></li>
<li><p><strong>tile_filter</strong> – (optional) Dict mapping slide names to tile indices.
If provided, will only save image tiles from this list.
Example:
{‘slide1’: [0, 16, 200]}</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.save_example_tiles_high_low">
<code class="sig-name descname">save_example_tiles_high_low</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nodes</span></em>, <em class="sig-param"><span class="n">slides</span></em>, <em class="sig-param"><span class="n">export_folder</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.save_example_tiles_high_low" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given set of activation nodes, saves images of tiles with the highest and lowest
activations in these nodes, restricted to the set of slides designated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nodes</strong> – List of int. Nodes with which to perform this function.</p></li>
<li><p><strong>slides</strong> – List of slide names. Will load tile images from these slides.</p></li>
<li><p><strong>export_folder</strong> – Path to directory in which to save image tiles.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.ActivationsVisualizer.slide_tile_dict">
<code class="sig-name descname">slide_tile_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.ActivationsVisualizer.slide_tile_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates dictionary mapping slides to list of node activations for each tile.</p>
<dl>
<dt>Example (3 nodes):</dt><dd><dl class="simple">
<dt>{ ‘Slide1’: [[0.1, 0.2, 0.4], # Slide1, node activations for tile1</dt><dd><p>[0.5, 0.1, 0.7], # Slide1, node activations for tile2
[0.6, 0.9, 0.1]] # Slide1, node activations for tile3</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="slideflow.activations.Heatmap">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.activations.</code><code class="sig-name descname">Heatmap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">slide_path</span></em>, <em class="sig-param"><span class="n">model_path</span></em>, <em class="sig-param"><span class="n">size_px</span></em>, <em class="sig-param"><span class="n">size_um</span></em>, <em class="sig-param"><span class="n">use_fp16</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">stride_div</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">roi_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">roi_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">roi_method</span><span class="o">=</span><span class="default_value">'inside'</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">16</span></em>, <em class="sig-param"><span class="n">skip_thumb</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">model_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.Heatmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates heatmap by calculating predictions from a sliding scale window across a slide.</p>
<dl class="py method">
<dt id="slideflow.activations.Heatmap.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">slide_path</span></em>, <em class="sig-param"><span class="n">model_path</span></em>, <em class="sig-param"><span class="n">size_px</span></em>, <em class="sig-param"><span class="n">size_um</span></em>, <em class="sig-param"><span class="n">use_fp16</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">stride_div</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">roi_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">roi_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">roi_method</span><span class="o">=</span><span class="default_value">'inside'</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">16</span></em>, <em class="sig-param"><span class="n">skip_thumb</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">model_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.Heatmap.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolutes across a whole slide, calculating logits and saving predictions internally for later use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slide_path</strong> – Path to slide</p></li>
<li><p><strong>model_path</strong> – Path to .h5 model file</p></li>
<li><p><strong>size_px</strong> – Size of image tiles, in pixels</p></li>
<li><p><strong>size_um</strong> – Size of image tiles, in microns</p></li>
<li><p><strong>use_fp16</strong> – Bool, whether to use FP16 (vs FP32)</p></li>
<li><p><strong>stride_div</strong> – Divisor for stride when convoluting across slide</p></li>
<li><p><strong>roi_dir</strong> – Directory in which slide ROI is contained</p></li>
<li><p><strong>roi_list</strong> – If a roi_dir is not supplied, a list of paths to ROI CSVs can be provided</p></li>
<li><p><strong>roi_method</strong> – Either ‘inside’, ‘outside’, or ‘ignore’. If inside, tiles will be extracted inside ROI region
If outside, tiles will be extracted outside ROI region</p></li>
<li><p><strong>buffer</strong> – Either ‘vmtouch’ or path to directory to use for buffering slides
Significantly improves performance for slides on HDDs</p></li>
<li><p><strong>normalizer</strong> – Normalization strategy to use on image tiles</p></li>
<li><p><strong>normalizer_source</strong> – Path to normalizer source image</p></li>
<li><p><strong>batch_size</strong> – Batch size when calculating predictions</p></li>
<li><p><strong>skip_thumb</strong> – If true, will skip thumbnail generation (can save time if saving heatmap without thumbnail image)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.Heatmap.display">
<code class="sig-name descname">display</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">show_roi</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">interpolation</span><span class="o">=</span><span class="default_value">'none'</span></em>, <em class="sig-param"><span class="n">logit_cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">skip_thumb</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.Heatmap.display" title="Permalink to this definition">¶</a></dt>
<dd><p>Interactively displays calculated logits as a heatmap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show_roi</strong> – Bool, whether to overlay ROIs onto heatmap image</p></li>
<li><p><strong>interpolation</strong> – Interpolation strategy to use for smoothing heatmap</p></li>
<li><p><strong>logit_cmap</strong> – <p>Either function or a dictionary use to create heatmap colormap.
Each image tile will generate a list of predictions of length O,
where O is the number of outcome categories.
If logit_cmap is a function, then this logit prediction list will be passed to the function,</p>
<blockquote>
<div><p>and the function is expected to return [R, G, B] values which will be displayed.</p>
</div></blockquote>
<dl>
<dt>If the logit_cmap is a dictionary, it should map ‘r’, ‘g’, and ‘b’ to outcome indices;</dt><dd><p>The prediction for these outcome categories will be mapped to the corresponding colors.
Thus, the corresponding color will only reflect predictions of up to three outcome categories.
Example (this would map prediction for outcome 0 to the red colorspace, outcome 3 to green colorspace, and so on):
{</p>
<blockquote>
<div><p>’r’: 0,
‘g’: 3,
‘b’: 1</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
</p></li>
<li><p><strong>skip_thumb</strong> – Bool, whether to skip thumbnail (vs displaying with heatmap)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.Heatmap.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_folder</span></em>, <em class="sig-param"><span class="n">show_roi</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">interpolation</span><span class="o">=</span><span class="default_value">'none'</span></em>, <em class="sig-param"><span class="n">logit_cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">skip_thumb</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.Heatmap.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves calculated logits as heatmap overlays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show_roi</strong> – Bool, whether to overlay ROIs onto heatmap image</p></li>
<li><p><strong>interpolation</strong> – Interpolation strategy to use for smoothing heatmap</p></li>
<li><p><strong>logit_cmap</strong> – <p>Either function or a dictionary use to create heatmap colormap.
Each image tile will generate a list of predictions of length O,
where O is the number of outcome categories.
If logit_cmap is a function, then this logit prediction list will be passed to the function,</p>
<blockquote>
<div><p>and the function is expected to return [R, G, B] values which will be displayed.</p>
</div></blockquote>
<dl>
<dt>If the logit_cmap is a dictionary, it should map ‘r’, ‘g’, and ‘b’ to outcome indices;</dt><dd><p>The prediction for these outcome categories will be mapped to the corresponding colors.
Thus, the corresponding color will only reflect predictions of up to three outcome categories.
Example (this would map prediction for outcome 0 to the red colorspace, outcome 3 to green colorspace, and so on):
{</p>
<blockquote>
<div><p>’r’: 0,
‘g’: 3,
‘b’: 1</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
</p></li>
<li><p><strong>skip_thumb</strong> – Bool, whether to skip thumbnail (vs displaying with heatmap)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="slideflow.activations.TileVisualizer">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.activations.</code><code class="sig-name descname">TileVisualizer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">node</span></em>, <em class="sig-param"><span class="n">tile_px</span></em>, <em class="sig-param"><span class="n">mask_width</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.TileVisualizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to supervize visualization of node activations across an image tile.
Visualization is accomplished by performing sequential convolutional masking</p>
<blockquote>
<div><p>and determining impact of masking on node activation. In this way,
the masking reveals spatial importance with respect to activation of the given node.</p>
</div></blockquote>
<dl class="py method">
<dt id="slideflow.activations.TileVisualizer.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">node</span></em>, <em class="sig-param"><span class="n">tile_px</span></em>, <em class="sig-param"><span class="n">mask_width</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.TileVisualizer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Object initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Path to .h5 model file</p></li>
<li><p><strong>node</strong> – Int, activation node to analyze</p></li>
<li><p><strong>tile_px</strong> – Int, width/height of image tiles</p></li>
<li><p><strong>mask_width</strong> – Width of mask to convolutionally apply. Defaults to 1/6 of tile_px</p></li>
<li><p><strong>normalizer</strong> – String, normalizer to apply to tiles in real-time.</p></li>
<li><p><strong>normalizer_source</strong> – Path to normalizer source image.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.activations.TileVisualizer.visualize_tile">
<code class="sig-name descname">visualize_tile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tfrecord</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">image_jpg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">export_folder</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">zoomed</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">interactive</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.activations.TileVisualizer.visualize_tile" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualizes tiles, either interactively or saving to directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tfrecord</strong> – If provided, will visualize tile from the designated tfrecord.
Must supply either a tfrecord and index or image_jpg</p></li>
<li><p><strong>index</strong> – Index of tile to visualize within tfrecord, if provided</p></li>
<li><p><strong>image_jpeg</strong> – JPG image to perform analysis on</p></li>
<li><p><strong>export_folder</strong> – Folder in which to save heatmap visualization</p></li>
<li><p><strong>zoomed</strong> – Bool. If true, will crop image to space containing heatmap (otherwise a small border will be seen)</p></li>
<li><p><strong>interactive</strong> – If true, will display as interactive map using matplotlib</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="io-datasets">
<h2>io.datasets<a class="headerlink" href="#io-datasets" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-slideflow.io.tfrecords">
<span id="io-tfrecords"></span><h2>io.tfrecords<a class="headerlink" href="#module-slideflow.io.tfrecords" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="slideflow.io.tfrecords.extract_tiles">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">extract_tiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tfrecord</span></em>, <em class="sig-param"><span class="n">destination</span></em>, <em class="sig-param"><span class="n">description</span><span class="o">=</span><span class="default_value">{'image_raw': FixedLenFeature(shape=[], dtype=tf.string, default_value=None), 'slide': FixedLenFeature(shape=[], dtype=tf.string, default_value=None)}</span></em>, <em class="sig-param"><span class="n">feature_label</span><span class="o">=</span><span class="default_value">'image_raw'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.extract_tiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads and saves images from a TFRecord to a destination folder.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.get_tfrecord_by_index">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">get_tfrecord_by_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tfrecord</span></em>, <em class="sig-param"><span class="n">index</span></em>, <em class="sig-param"><span class="n">decode</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.get_tfrecord_by_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads and returns an individual record from a tfrecord by index, including slide name and JPEG-processed image data.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.get_training_and_validation_tfrecords">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">get_training_and_validation_tfrecords</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">validation_log</span></em>, <em class="sig-param"><span class="n">outcomes</span></em>, <em class="sig-param"><span class="n">model_type</span></em>, <em class="sig-param"><span class="n">validation_target</span></em>, <em class="sig-param"><span class="n">validation_strategy</span></em>, <em class="sig-param"><span class="n">validation_fraction</span></em>, <em class="sig-param"><span class="n">validation_k_fold</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">k_fold_iter</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">read_only</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.get_training_and_validation_tfrecords" title="Permalink to this definition">¶</a></dt>
<dd><p>From a specified subfolder within the project’s main TFRecord folder, prepare a training set and validation set.
If a validation plan has already been prepared (e.g. K-fold iterations were already determined), the previously generated plan will be used.
Otherwise, create a new plan and log the result in the TFRecord directory so future models may use the same plan for consistency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – A slideflow.datasets.Dataset object</p></li>
<li><p><strong>validation_log</strong> – Path to .log file containing validation plans</p></li>
<li><p><strong>outcomes</strong> – Dictionary mapping slides to outcomes (used for balancing outcomes in training and validation cohorts)</p></li>
<li><p><strong>model_type</strong> – Either ‘categorical’ or ‘linear’</p></li>
<li><p><strong>validation_target</strong> – Either ‘per-slide’ or ‘per-tile’</p></li>
<li><p><strong>validation_strategy</strong> – Either ‘k-fold’, ‘bootstrap’, or ‘fixed’.</p></li>
<li><p><strong>validation_fraction</strong> – Float, proportion of data for validation. Not used if strategy is k-fold.</p></li>
<li><p><strong>validation_k_fold</strong> – K, if using K-fold validation.</p></li>
<li><p><strong>k_fold_iter</strong> – Which K-fold iteration, if using K-fold validation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an array of full paths to training tfrecords, and an array of paths to validation tfrecords.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Two arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.image_example">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">image_example</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">slide</span></em>, <em class="sig-param"><span class="n">image_string</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.image_example" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Tensorflow Data example for TFRecord storage.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.join_tfrecord">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">join_tfrecord</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_folder</span></em>, <em class="sig-param"><span class="n">output_file</span></em>, <em class="sig-param"><span class="n">assign_slide</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.join_tfrecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly samples from tfrecords in the input folder with shuffling,
and combines into a single tfrecord file.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.merge_split_tfrecords">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">merge_split_tfrecords</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">source</span></em>, <em class="sig-param"><span class="n">destination</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.merge_split_tfrecords" title="Permalink to this definition">¶</a></dt>
<dd><p>Merges TFRecords with the same name in subfolders within the given source folder,
as may be the case when using split TFRecords for tile-level validation.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.multi_image_example">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">multi_image_example</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">slide</span></em>, <em class="sig-param"><span class="n">image_dict</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.multi_image_example" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Tensorflow Data example for TFRecord storage with multiple images.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.print_tfrecord">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">print_tfrecord</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">target</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.print_tfrecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the slide names for records in the given tfrecord file</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.shuffle_tfrecord">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">shuffle_tfrecord</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">target</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.shuffle_tfrecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Shuffles records in a TFRecord, saving the original to a .old file.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.shuffle_tfrecords_by_dir">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">shuffle_tfrecords_by_dir</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">directory</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.shuffle_tfrecords_by_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>For each TFRecord in a directory, shuffles records in the TFRecord, saving the original to a .old file.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.split_patients_list">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">split_patients_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">patients_dict</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">balance</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">randomize</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.split_patients_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits a dictionary of patients into n groups, balancing according to key “balance” if provided.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.split_tfrecord">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">split_tfrecord</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tfrecord_file</span></em>, <em class="sig-param"><span class="n">output_folder</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.split_tfrecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits records from a single tfrecord file into individual tfrecord files by slide.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.transform_tfrecord">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">transform_tfrecord</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">target</span></em>, <em class="sig-param"><span class="n">assign_slide</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">hue_shift</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">resize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">silent</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.transform_tfrecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms images in a single tfrecord. Can perform hue shifting, resizing, or re-assigning slide label.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.update_tfrecord">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">update_tfrecord</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tfrecord_file</span></em>, <em class="sig-param"><span class="n">old_feature_description</span><span class="o">=</span><span class="default_value">{'image_raw': FixedLenFeature(shape=[], dtype=tf.string, default_value=None), 'slide': FixedLenFeature(shape=[], dtype=tf.string, default_value=None)}</span></em>, <em class="sig-param"><span class="n">slide</span><span class="o">=</span><span class="default_value">'slide'</span></em>, <em class="sig-param"><span class="n">image_raw</span><span class="o">=</span><span class="default_value">'image_raw'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.update_tfrecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates a single tfrecord from an old format to a new format.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.update_tfrecord_dir">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">update_tfrecord_dir</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">directory</span></em>, <em class="sig-param"><span class="n">old_feature_description</span><span class="o">=</span><span class="default_value">{'image_raw': FixedLenFeature(shape=[], dtype=tf.string, default_value=None), 'slide': FixedLenFeature(shape=[], dtype=tf.string, default_value=None)}</span></em>, <em class="sig-param"><span class="n">slide</span><span class="o">=</span><span class="default_value">'slide'</span></em>, <em class="sig-param"><span class="n">image_raw</span><span class="o">=</span><span class="default_value">'image_raw'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.update_tfrecord_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates tfrecords in a directory from an old format to a new format.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.write_tfrecords_merge">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">write_tfrecords_merge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_directory</span></em>, <em class="sig-param"><span class="n">output_directory</span></em>, <em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.write_tfrecords_merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Scans a folder for subfolders, assumes subfolders are slide names. Assembles all image tiles within
subfolders and labels using the provided annotation_dict, assuming the subfolder is the slide name.
Collects all image tiles and exports into a single tfrecord file.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.write_tfrecords_multi">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">write_tfrecords_multi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_directory</span></em>, <em class="sig-param"><span class="n">output_directory</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.write_tfrecords_multi" title="Permalink to this definition">¶</a></dt>
<dd><p>Scans a folder for subfolders, assumes subfolders are slide names. Assembles all image tiles within
subfolders and labels using the provided annotation_dict, assuming the subfolder is the slide name.
Collects all image tiles and exports into multiple tfrecord files, one for each slide.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.io.tfrecords.write_tfrecords_single">
<code class="sig-prename descclassname">slideflow.io.tfrecords.</code><code class="sig-name descname">write_tfrecords_single</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_directory</span></em>, <em class="sig-param"><span class="n">output_directory</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">slide</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.io.tfrecords.write_tfrecords_single" title="Permalink to this definition">¶</a></dt>
<dd><p>Scans a folder for image tiles, annotates using the provided slide, exports
into a single tfrecord file.</p>
</dd></dl>

</div>
<div class="section" id="module-slideflow.model">
<span id="model"></span><h2>model<a class="headerlink" href="#module-slideflow.model" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt id="slideflow.model.HyperParameterError">
<em class="property">exception </em><code class="sig-prename descclassname">slideflow.model.</code><code class="sig-name descname">HyperParameterError</code><a class="headerlink" href="#slideflow.model.HyperParameterError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="slideflow.model.HyperParameters">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.model.</code><code class="sig-name descname">HyperParameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tile_px</span><span class="o">=</span><span class="default_value">299</span></em>, <em class="sig-param"><span class="n">tile_um</span><span class="o">=</span><span class="default_value">302</span></em>, <em class="sig-param"><span class="n">finetune_epochs</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">toplayer_epochs</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">'Xception'</span></em>, <em class="sig-param"><span class="n">pooling</span><span class="o">=</span><span class="default_value">'max'</span></em>, <em class="sig-param"><span class="n">loss</span><span class="o">=</span><span class="default_value">'sparse_categorical_crossentropy'</span></em>, <em class="sig-param"><span class="n">learning_rate</span><span class="o">=</span><span class="default_value">0.0001</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">16</span></em>, <em class="sig-param"><span class="n">hidden_layers</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">hidden_layer_width</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">optimizer</span><span class="o">=</span><span class="default_value">'Adam'</span></em>, <em class="sig-param"><span class="n">early_stop</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">early_stop_patience</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">early_stop_method</span><span class="o">=</span><span class="default_value">'loss'</span></em>, <em class="sig-param"><span class="n">balanced_training</span><span class="o">=</span><span class="default_value">'BALANCE_BY_CATEGORY'</span></em>, <em class="sig-param"><span class="n">balanced_validation</span><span class="o">=</span><span class="default_value">'NO_BALANCE'</span></em>, <em class="sig-param"><span class="n">trainable_layers</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">L2_weight</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">augment</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.model.HyperParameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Object to supervise construction of a set of hyperparameters for Slideflow models.</p>
<dl class="py method">
<dt id="slideflow.model.HyperParameters.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tile_px</span><span class="o">=</span><span class="default_value">299</span></em>, <em class="sig-param"><span class="n">tile_um</span><span class="o">=</span><span class="default_value">302</span></em>, <em class="sig-param"><span class="n">finetune_epochs</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">toplayer_epochs</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">'Xception'</span></em>, <em class="sig-param"><span class="n">pooling</span><span class="o">=</span><span class="default_value">'max'</span></em>, <em class="sig-param"><span class="n">loss</span><span class="o">=</span><span class="default_value">'sparse_categorical_crossentropy'</span></em>, <em class="sig-param"><span class="n">learning_rate</span><span class="o">=</span><span class="default_value">0.0001</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">16</span></em>, <em class="sig-param"><span class="n">hidden_layers</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">hidden_layer_width</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">optimizer</span><span class="o">=</span><span class="default_value">'Adam'</span></em>, <em class="sig-param"><span class="n">early_stop</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">early_stop_patience</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">early_stop_method</span><span class="o">=</span><span class="default_value">'loss'</span></em>, <em class="sig-param"><span class="n">balanced_training</span><span class="o">=</span><span class="default_value">'BALANCE_BY_CATEGORY'</span></em>, <em class="sig-param"><span class="n">balanced_validation</span><span class="o">=</span><span class="default_value">'NO_BALANCE'</span></em>, <em class="sig-param"><span class="n">trainable_layers</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">L2_weight</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">augment</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.model.HyperParameters.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.model.HyperParameters.get_model">
<code class="sig-name descname">get_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_shape</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">input_tensor</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weights</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.model.HyperParameters.get_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Keras model of the appropriate architecture, input shape, pooling, and initial weights.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.model.HyperParameters.get_opt">
<code class="sig-name descname">get_opt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.model.HyperParameters.get_opt" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns optimizer with appropriate learning rate.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.model.HyperParameters.model_type">
<code class="sig-name descname">model_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.model.HyperParameters.model_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns either ‘linear’ or ‘categorical’ depending on the loss type.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.model.HyperParameters.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.model.HyperParameters.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures that hyperparameter combinations are valid.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="slideflow.model.ManifestError">
<em class="property">exception </em><code class="sig-prename descclassname">slideflow.model.</code><code class="sig-name descname">ManifestError</code><a class="headerlink" href="#slideflow.model.ManifestError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="slideflow.model.ModelActivationsInterface">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.model.</code><code class="sig-name descname">ModelActivationsInterface</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">model_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.model.ModelActivationsInterface" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides an interface to obtain logits and penultimate activations from saved Slideflow Keras models.
Provides support for newer models (v1.9.1+) and legacy slideflow models (1.9.0b and earlier)</p>
<dl class="py method">
<dt id="slideflow.model.ModelActivationsInterface.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">model_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.model.ModelActivationsInterface.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – Path to saved Slideflow Keras model</p></li>
<li><p><strong>model_format</strong> – Either slideflow.model.MODEL_FORMAT_CURRENT or _LEGACY. Indicates how the saved model should be processed,
as older versions of Slideflow had models constructed differently, with differing naming of Keras layers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.model.ModelActivationsInterface.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_batch</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.model.ModelActivationsInterface.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a batch of images, will return a batch of penultimate activations and a batch of logits.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="slideflow.model.ModelError">
<em class="property">exception </em><code class="sig-prename descclassname">slideflow.model.</code><code class="sig-name descname">ModelError</code><a class="headerlink" href="#slideflow.model.ModelError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="slideflow.model.SlideflowModel">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.model.</code><code class="sig-name descname">SlideflowModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_directory</span></em>, <em class="sig-param"><span class="n">image_size</span></em>, <em class="sig-param"><span class="n">slide_annotations</span></em>, <em class="sig-param"><span class="n">train_tfrecords</span></em>, <em class="sig-param"><span class="n">validation_tfrecords</span></em>, <em class="sig-param"><span class="n">manifest</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_fp16</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">model_type</span><span class="o">=</span><span class="default_value">'categorical'</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_slide_input</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.model.SlideflowModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Model containing all functions necessary to build input dataset pipelines,
build a training and validation set model, and monitor and execute training.</p>
<dl class="py method">
<dt id="slideflow.model.SlideflowModel.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_directory</span></em>, <em class="sig-param"><span class="n">image_size</span></em>, <em class="sig-param"><span class="n">slide_annotations</span></em>, <em class="sig-param"><span class="n">train_tfrecords</span></em>, <em class="sig-param"><span class="n">validation_tfrecords</span></em>, <em class="sig-param"><span class="n">manifest</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_fp16</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">model_type</span><span class="o">=</span><span class="default_value">'categorical'</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_slide_input</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.model.SlideflowModel.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Model initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_directory</strong> – Location where event logs and checkpoints will be written</p></li>
<li><p><strong>image_size</strong> – Int, width/height of input image in pixels.</p></li>
<li><p><strong>slide_annotations</strong> – Dictionary mapping slide names to both patient names and outcome</p></li>
<li><p><strong>train_tfrecords</strong> – List of tfrecord paths for training</p></li>
<li><p><strong>validation_tfrecords</strong> – List of tfrecord paths for validation</p></li>
<li><p><strong>manifest</strong> – Manifest dictionary mapping TFRecords to number of tiles</p></li>
<li><p><strong>use_fp16</strong> – Bool, if True, will use FP16 (rather than FP32)</p></li>
<li><p><strong>model_type</strong> – Type of model outcome, either ‘categorical’ or ‘linear’</p></li>
<li><p><strong>normalizer</strong> – Tile image normalization to perform in real-time during training</p></li>
<li><p><strong>normalizer_source</strong> – Source image for normalization if being performed in real-time</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.model.SlideflowModel.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tfrecords</span></em>, <em class="sig-param"><span class="n">hp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model_type</span><span class="o">=</span><span class="default_value">'categorical'</span></em>, <em class="sig-param"><span class="n">checkpoint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_tiles_per_slide</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">min_tiles_per_slide</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">multi_image</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.model.SlideflowModel.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tfrecords</strong> – List of TFrecords paths to load for evaluation.</p></li>
<li><p><strong>hp</strong> – HyperParameters object</p></li>
<li><p><strong>model</strong> – Optional; .h5 model to load for evaluation. If None, will build model using hyperparameters.</p></li>
<li><p><strong>model_type</strong> – Either linear or categorical.</p></li>
<li><p><strong>checkpoint</strong> – Path to cp.cpkt checkpoint. If provided, will update model with given checkpoint weights.</p></li>
<li><p><strong>batch_size</strong> – Evaluation batch size.</p></li>
<li><p><strong>max_tiles_per_slide</strong> – If provided, will select only up to this maximum number of tiles from each slide.</p></li>
<li><p><strong>min_tiles_per_slide</strong> – If provided, will only evaluate slides with a given minimum number of tiles.</p></li>
<li><p><strong>multi_image</strong> – If true, will evaluate model with multi-image inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Keras history object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.model.SlideflowModel.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hp</span></em>, <em class="sig-param"><span class="n">pretrain</span><span class="o">=</span><span class="default_value">'imagenet'</span></em>, <em class="sig-param"><span class="n">resume_training</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">checkpoint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log_frequency</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">multi_image</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">validate_on_batch</span><span class="o">=</span><span class="default_value">512</span></em>, <em class="sig-param"><span class="n">val_batch_size</span><span class="o">=</span><span class="default_value">32</span></em>, <em class="sig-param"><span class="n">validation_steps</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">max_tiles_per_slide</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">min_tiles_per_slide</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">starting_epoch</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">ema_observations</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">ema_smoothing</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.model.SlideflowModel.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the model for a number of steps, according to flags set by the argument parser.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hp</strong> – HyperParameters object</p></li>
<li><p><strong>pretrain</strong> – Either None, ‘imagenet’ or path to .h5 file for pretrained weights</p></li>
<li><p><strong>resume_training</strong> – If True, will attempt to resume previously aborted training</p></li>
<li><p><strong>checkpoint</strong> – Path to cp.cpkt checkpoint file. If provided, will load checkpoint weights</p></li>
<li><p><strong>log_frequency</strong> – How frequent to update Tensorboard logs</p></li>
<li><p><strong>multi_image</strong> – If True, will train model with multi-image inputs</p></li>
<li><p><strong>validate_on_batch</strong> – Validation will be performed every X batches</p></li>
<li><p><strong>val_batch_size</strong> – Batch size to use during validation</p></li>
<li><p><strong>validation_steps</strong> – Number of batches to use for each instance of validation</p></li>
<li><p><strong>max_tiles_per_slide</strong> – If provided, will select only up to this maximum number of tiles from each slide</p></li>
<li><p><strong>min_tiles_per_slide</strong> – If provided, will only evaluate slides with a given minimum number of tiles</p></li>
<li><p><strong>starting_epoch</strong> – Starts training at the specified epoch</p></li>
<li><p><strong>ema_observations</strong> – Number of observations over which to perform exponential moving average smoothing</p></li>
<li><p><strong>ema_smoothing</strong> – Exponential average smoothing value</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Results dictionary, Keras history object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="slideflow.model.add_regularization">
<code class="sig-prename descclassname">slideflow.model.</code><code class="sig-name descname">add_regularization</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">regularizer</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.model.add_regularization" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds regularization (e.g. L2) to all eligible layers of a model.
This function is from “<a class="reference external" href="https://sthalles.github.io/keras-regularizer/">https://sthalles.github.io/keras-regularizer/</a>”</p>
</dd></dl>

</div>
<div class="section" id="module-slideflow.slide">
<span id="slide"></span><h2>slide<a class="headerlink" href="#module-slideflow.slide" title="Permalink to this headline">¶</a></h2>
<p>This module includes tools to convolutionally section whole slide images into tiles
using python Generators. These tessellated tiles can be exported as JPGs, with or without
data augmentation, or used as input for a trained Tensorflow model. Model predictions
can then be visualized as a heatmap overlay.</p>
<p>Requires: libvips (<a class="reference external" href="https://libvips.github.io/libvips/">https://libvips.github.io/libvips/</a>).</p>
<dl class="py class">
<dt id="slideflow.slide.ExtractionPDF">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.slide.</code><code class="sig-name descname">ExtractionPDF</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orientation</span><span class="o">=</span><span class="default_value">'P'</span></em>, <em class="sig-param"><span class="n">unit</span><span class="o">=</span><span class="default_value">'mm'</span></em>, <em class="sig-param"><span class="n">format</span><span class="o">=</span><span class="default_value">'A4'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.ExtractionPDF" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="slideflow.slide.ExtractionPDF.footer">
<code class="sig-name descname">footer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.ExtractionPDF.footer" title="Permalink to this definition">¶</a></dt>
<dd><p>Footer to be implemented in your own inherited class</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="slideflow.slide.ExtractionReport">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.slide.</code><code class="sig-name descname">ExtractionReport</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reports</span></em>, <em class="sig-param"><span class="n">tile_px</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tile_um</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.ExtractionReport" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a PDF report summarizing extracted tiles,
from a collection of tile extraction reports.</p>
<dl class="py method">
<dt id="slideflow.slide.ExtractionReport.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reports</span></em>, <em class="sig-param"><span class="n">tile_px</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tile_um</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.ExtractionReport.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reports</strong> – List of SlideReport objects</p></li>
<li><p><strong>tile_px</strong> – Tile size in pixels.</p></li>
<li><p><strong>tile_um</strong> – Tile size in microns.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="slideflow.slide.InvalidTileSplitException">
<em class="property">exception </em><code class="sig-prename descclassname">slideflow.slide.</code><code class="sig-name descname">InvalidTileSplitException</code><a class="headerlink" href="#slideflow.slide.InvalidTileSplitException" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when invalid tile splitting parameters are given to SlideReader.</p>
</dd></dl>

<dl class="py class">
<dt id="slideflow.slide.JPGslideToVIPS">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.slide.</code><code class="sig-name descname">JPGslideToVIPS</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.JPGslideToVIPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for JPG files, which do not possess separate levels, to preserve openslide-like functions.</p>
<dl class="py method">
<dt id="slideflow.slide.JPGslideToVIPS.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.JPGslideToVIPS.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="slideflow.slide.OpenslideToVIPS">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.slide.</code><code class="sig-name descname">OpenslideToVIPS</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.OpenslideToVIPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for VIPS to preserve openslide-like functions.</p>
<dl class="py method">
<dt id="slideflow.slide.OpenslideToVIPS.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.OpenslideToVIPS.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.OpenslideToVIPS.get_best_level_for_downsample">
<code class="sig-name descname">get_best_level_for_downsample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">downsample</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.OpenslideToVIPS.get_best_level_for_downsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Return best level to match a given desired downsample.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.OpenslideToVIPS.get_downsampled_image">
<code class="sig-name descname">get_downsampled_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">level</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.OpenslideToVIPS.get_downsampled_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a VIPS image of a given downsample.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.OpenslideToVIPS.read_region">
<code class="sig-name descname">read_region</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">base_level_dim</span></em>, <em class="sig-param"><span class="n">downsample_level</span></em>, <em class="sig-param"><span class="n">extract_size</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.OpenslideToVIPS.read_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts a region from the image at the given downsample level.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="slideflow.slide.ROIObject">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.slide.</code><code class="sig-name descname">ROIObject</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.ROIObject" title="Permalink to this definition">¶</a></dt>
<dd><p>Object container for ROI annotations.</p>
<dl class="py method">
<dt id="slideflow.slide.ROIObject.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.ROIObject.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="slideflow.slide.SlideLoader">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.slide.</code><code class="sig-name descname">SlideLoader</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">size_px</span></em>, <em class="sig-param"><span class="n">size_um</span></em>, <em class="sig-param"><span class="n">stride_div</span></em>, <em class="sig-param"><span class="n">enable_downsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">silent</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideLoader" title="Permalink to this definition">¶</a></dt>
<dd><p>Object that loads an SVS slide and makes preparations for tile extraction.
Should not be used directly; this class must be inherited and extended by a child class!</p>
<dl class="py method">
<dt id="slideflow.slide.SlideLoader.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">size_px</span></em>, <em class="sig-param"><span class="n">size_um</span></em>, <em class="sig-param"><span class="n">stride_div</span></em>, <em class="sig-param"><span class="n">enable_downsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">silent</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideLoader.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.SlideLoader.loaded_correctly">
<code class="sig-name descname">loaded_correctly</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideLoader.loaded_correctly" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if slide loaded correctly without errors; False if otherwise.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.SlideLoader.square_thumb">
<code class="sig-name descname">square_thumb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">512</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideLoader.square_thumb" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a square thumbnail of the slide, with black bar borders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>width</strong> – Width/height of thumbnail in pixels.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PIL image</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.SlideLoader.thumb">
<code class="sig-name descname">thumb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mpp</span><span class="o">=</span><span class="default_value">55</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideLoader.thumb" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns PIL thumbnail of the slide.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mpp</strong> – Microns-per-pixel of thumbnail (determines size of thumbnail to return)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PIL image</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="slideflow.slide.SlideReader">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.slide.</code><code class="sig-name descname">SlideReader</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">size_px</span></em>, <em class="sig-param"><span class="n">size_um</span></em>, <em class="sig-param"><span class="n">stride_div</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">enable_downsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">roi_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">roi_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">roi_method</span><span class="o">=</span><span class="default_value">'inside'</span></em>, <em class="sig-param"><span class="n">skip_missing_roi</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">silent</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pb_id</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper object that loads a slide and its ROI annotations and sets up a tile generator.</p>
<dl class="py method">
<dt id="slideflow.slide.SlideReader.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">size_px</span></em>, <em class="sig-param"><span class="n">size_um</span></em>, <em class="sig-param"><span class="n">stride_div</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">enable_downsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">roi_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">roi_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">roi_method</span><span class="o">=</span><span class="default_value">'inside'</span></em>, <em class="sig-param"><span class="n">skip_missing_roi</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">silent</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pb_id</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideReader.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – Path to slide</p></li>
<li><p><strong>size_px</strong> – Size of tiles to extract, in pixels</p></li>
<li><p><strong>size_um</strong> – Size of tiles to extract, in microns</p></li>
<li><p><strong>stride_div</strong> – Stride divisor for tile extraction (1 = no tile overlap; 2 = 50% overlap, etc)</p></li>
<li><p><strong>enable_downsample</strong> – Bool, if True, allows use of downsampled intermediate layers in the slide image pyramid,
which greatly improves tile extraction speed.</p></li>
<li><p><strong>roi_dir</strong> – Directory in which to search for ROI CSV files</p></li>
<li><p><strong>roi_list</strong> – Alternatively, a list of ROI paths can be explicitly provided</p></li>
<li><p><strong>roi_method</strong> – Either inside, outside, or ignore. Determines how ROIs are used to extract tiles</p></li>
<li><p><strong>skip_missing_roi</strong> – Bool, if True, will skip tiles that are missing a ROI file</p></li>
<li><p><strong>silent</strong> – Bool, if True, will hide logging output</p></li>
<li><p><strong>buffer</strong> – Either ‘vmtouch’ or path to directory. If vmtouch, will use vmtouch to preload slide into memory before extraction.
If a directory, slides will be copied to the directory as a buffer before extraction.
Either method vastly improves tile extraction for slides on HDDs by maximizing sequential read speed</p></li>
<li><p><strong>pb</strong> – ProgressBar instance; will update progress bar during tile extraction if provided</p></li>
<li><p><strong>pb_id</strong> – ID of bar in ProgressBar, defaults to 0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.SlideReader.annotated_thumb">
<code class="sig-name descname">annotated_thumb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mpp</span><span class="o">=</span><span class="default_value">55</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideReader.annotated_thumb" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns PIL Image of thumbnail with ROI overlay.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mpp</strong> – Microns-per-pixel, used to determine thumbnail size</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PIL image</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.SlideReader.build_generator">
<code class="sig-name descname">build_generator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dual_extract</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">shuffle</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">whitespace_fraction</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">whitespace_threshold</span><span class="o">=</span><span class="default_value">230</span></em>, <em class="sig-param"><span class="n">grayspace_fraction</span><span class="o">=</span><span class="default_value">0.6</span></em>, <em class="sig-param"><span class="n">grayspace_threshold</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideReader.build_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds generator to supervise extraction of tiles across the slide.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dual_extract</strong> – If true, will extract base image and the surrounding region.</p></li>
<li><p><strong>shuffle</strong> – If true, will shuffle images during extraction</p></li>
<li><p><strong>whitespace_fraction</strong> – Float from 0-1, representing a percent. Tiles with this percent of pixels (or more) classified as “whitespace”
will be skipped during extraction.</p></li>
<li><p><strong>whitespace_threshold</strong> – Int from 0-255, pixel brightness above which a pixel is considered whitespace</p></li>
<li><p><strong>normalizer</strong> – Normalization strategy to use on image tiles</p></li>
<li><p><strong>normalizer_source</strong> – Path to normalizer source image</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.SlideReader.extract_tiles">
<code class="sig-name descname">extract_tiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tfrecord_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tiles_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">split_fraction</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">split_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">whitespace_fraction</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">whitespace_threshold</span><span class="o">=</span><span class="default_value">230</span></em>, <em class="sig-param"><span class="n">grayspace_fraction</span><span class="o">=</span><span class="default_value">0.6</span></em>, <em class="sig-param"><span class="n">grayspace_threshold</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">shuffle</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideReader.extract_tiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Extractes tiles from slide and saves into a TFRecord file or as loose JPG tiles in a directory.
:param tfrecord_dir: If provided, saves tiles into a TFRecord file (named according to slide name) in this directory.
:param tiles_dir: If provided, saves loose JPG tiles into a subdirectory (named according to slide name) in this directory.
:param split_fraction: List of float. If provided, splits the extracted tiles into subsets (e.g. for validation set) using these fractions.</p>
<blockquote>
<div><p>Should add up to 1 (except for fractions of -1). Remaining tiles are split between fractions of “-1”.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_names</strong> – List of names to label the split fractions</p></li>
<li><p><strong>whitespace_fraction</strong> – Int from 0-100, representing a percent. Tiles with this percent of pixels classified as “whitespace”
will be skipped during extraction.</p></li>
<li><p><strong>whitespace_threshold</strong> – Int from 0-255, pixel brightness above which a pixel is considered whitespace</p></li>
<li><p><strong>normalizer</strong> – Normalization strategy to use on image tiles</p></li>
<li><p><strong>normalizer_source</strong> – Path to normalizer source image</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.SlideReader.load_csv_roi">
<code class="sig-name descname">load_csv_roi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideReader.load_csv_roi" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads CSV ROI from a given path.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.SlideReader.load_json_roi">
<code class="sig-name descname">load_json_roi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">scale</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideReader.load_json_roi" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads ROI from a JSON file.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="slideflow.slide.SlideReport">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.slide.</code><code class="sig-name descname">SlideReport</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">images</span></em>, <em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">compress</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideReport" title="Permalink to this definition">¶</a></dt>
<dd><p>Report to summarize tile extraction from a slide,
including example images of extracted tiles.</p>
<dl class="py method">
<dt id="slideflow.slide.SlideReport.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">images</span></em>, <em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">compress</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideReport.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>images</strong> – List of JPEG image strings (example tiles)</p></li>
<li><p><strong>path</strong> – Path to slide</p></li>
<li><p><strong>data</strong> – Dictionary of slide extraction report metadata</p></li>
<li><p><strong>compress</strong> – Bool, if True, compresses images to reduce image sizes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.SlideReport.image_row">
<code class="sig-name descname">image_row</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.SlideReport.image_row" title="Permalink to this definition">¶</a></dt>
<dd><p>Merges images into a single row of images</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="slideflow.slide.StainNormalizer">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.slide.</code><code class="sig-name descname">StainNormalizer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'macenko'</span></em>, <em class="sig-param"><span class="n">source</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.StainNormalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Object to supervise stain normalization for images and
efficiently convert between common image types.</p>
<dl class="py method">
<dt id="slideflow.slide.StainNormalizer.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'macenko'</span></em>, <em class="sig-param"><span class="n">source</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.StainNormalizer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializer. Establishes normalization method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> – Either ‘macenko’, ‘reinhard’, or ‘vahadane’.</p></li>
<li><p><strong>source</strong> – Path to source image for normalizer.
If not provided, defaults to an internal example image.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.StainNormalizer.jpeg_to_jpeg">
<code class="sig-name descname">jpeg_to_jpeg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">jpeg_string</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.StainNormalizer.jpeg_to_jpeg" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-normalized compressed JPG string data -&gt; normalized compressed JPG string data</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.StainNormalizer.jpeg_to_rgb">
<code class="sig-name descname">jpeg_to_rgb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">jpeg_string</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.StainNormalizer.jpeg_to_rgb" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-normalized compressed JPG string data -&gt; normalized RGB numpy array</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.StainNormalizer.pil_to_pil">
<code class="sig-name descname">pil_to_pil</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.StainNormalizer.pil_to_pil" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-normalized PIL.Image -&gt; normalized PIL.Image</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.StainNormalizer.rgb_to_rgb">
<code class="sig-name descname">rgb_to_rgb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.StainNormalizer.rgb_to_rgb" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-normalized RGB numpy array -&gt; normalized RGB numpy array</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.StainNormalizer.tf_to_rgb">
<code class="sig-name descname">tf_to_rgb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.StainNormalizer.tf_to_rgb" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-normalized tensorflow image array -&gt; normalized RGB numpy array</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="slideflow.slide.TMAReader">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.slide.</code><code class="sig-name descname">TMAReader</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">size_px</span></em>, <em class="sig-param"><span class="n">size_um</span></em>, <em class="sig-param"><span class="n">stride_div</span></em>, <em class="sig-param"><span class="n">enable_downsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">export_folder</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">roi_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">roi_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.TMAReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper object that loads a TMA-formatted slide, detects tissue cores, and sets up a tile generator.</p>
<dl class="py method">
<dt id="slideflow.slide.TMAReader.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">size_px</span></em>, <em class="sig-param"><span class="n">size_um</span></em>, <em class="sig-param"><span class="n">stride_div</span></em>, <em class="sig-param"><span class="n">enable_downsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">export_folder</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">roi_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">roi_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.TMAReader.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.TMAReader.build_generator">
<code class="sig-name descname">build_generator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">export</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">augment</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">export_full_core</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.TMAReader.build_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds generator to supervise extraction of tiles across the slide.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>export</strong> – If true, will save tiles to the export_folder while extracting tiles.</p></li>
<li><p><strong>augment</strong> – If true, will save flipped/rotated tiles while extracting.</p></li>
<li><p><strong>export_full_core</strong> – If true, will also save a thumbnail of each fully extracted core.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.slide.TMAReader.extract_tiles">
<code class="sig-name descname">extract_tiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">augment</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">export_full_core</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.TMAReader.extract_tiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports all tiles.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="slideflow.slide.TileCorruptionError">
<em class="property">exception </em><code class="sig-prename descclassname">slideflow.slide.</code><code class="sig-name descname">TileCorruptionError</code><a class="headerlink" href="#slideflow.slide.TileCorruptionError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when image normalization fails due to tile corruption.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.slide.vips2numpy">
<code class="sig-prename descclassname">slideflow.slide.</code><code class="sig-name descname">vips2numpy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.slide.vips2numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a VIPS image into a numpy array</p>
</dd></dl>

</div>
<div class="section" id="module-slideflow.mosaic">
<span id="mosaic"></span><h2>mosaic<a class="headerlink" href="#module-slideflow.mosaic" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="slideflow.mosaic.Mosaic">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.mosaic.</code><code class="sig-name descname">Mosaic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">umap</span></em>, <em class="sig-param"><span class="n">focus</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">leniency</span><span class="o">=</span><span class="default_value">1.5</span></em>, <em class="sig-param"><span class="n">expanded</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">tile_zoom</span><span class="o">=</span><span class="default_value">15</span></em>, <em class="sig-param"><span class="n">num_tiles_x</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">resolution</span><span class="o">=</span><span class="default_value">'high'</span></em>, <em class="sig-param"><span class="n">relative_size</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">tile_select</span><span class="o">=</span><span class="default_value">'nearest'</span></em>, <em class="sig-param"><span class="n">tile_meta</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.mosaic.Mosaic" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualization of tiles as mapped using dimensionality reduction.</p>
<dl class="py method">
<dt id="slideflow.mosaic.Mosaic.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">umap</span></em>, <em class="sig-param"><span class="n">focus</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">leniency</span><span class="o">=</span><span class="default_value">1.5</span></em>, <em class="sig-param"><span class="n">expanded</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">tile_zoom</span><span class="o">=</span><span class="default_value">15</span></em>, <em class="sig-param"><span class="n">num_tiles_x</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">resolution</span><span class="o">=</span><span class="default_value">'high'</span></em>, <em class="sig-param"><span class="n">relative_size</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">tile_select</span><span class="o">=</span><span class="default_value">'nearest'</span></em>, <em class="sig-param"><span class="n">tile_meta</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer_source</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.mosaic.Mosaic.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a mosaic map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>umap</strong> – TFRecordMap object</p></li>
<li><p><strong>focus</strong> – List of tfrecords (paths) to highlight on the mosaic</p></li>
<li><p><strong>leniency</strong> – UMAP leniency</p></li>
<li><p><strong>expanded</strong> – If true, will try to fill in blank spots on the UMAP with nearby tiles. Takes exponentially longer to generate.</p></li>
<li><p><strong>tile_zoom</strong> – Zoom level</p></li>
<li><p><strong>num_tiles_x</strong> – Mosaic map grid size</p></li>
<li><p><strong>resolution</strong> – Resolution of exported figure; either ‘high’, ‘medium’, or ‘low’.</p></li>
<li><p><strong>relative_size</strong> – If True, will physically size grid images in proportion to the number of tiles within the grid space.</p></li>
<li><p><strong>tile_select</strong> – Determines how to choose a tile for display on each grid space. Either ‘nearest’ or ‘centroid’.
If nearest, will display tile nearest to center of grid.
If centroid, for each grid, will calculate which tile is nearest to centroid using data in tile_meta</p></li>
<li><p><strong>tile_meta</strong> – Dictionary. Metadata for tiles, used if tile_select. Dictionary should have slide names as keys, mapped to
List of metadata (length of list = number of tiles in slide)</p></li>
<li><p><strong>normalizer</strong> – String. Normalizer to apply to images taken from TFRecords.</p></li>
<li><p><strong>normalizer_source</strong> – String, path. Path to image to use as normalizer source.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.mosaic.Mosaic.display">
<code class="sig-name descname">display</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.mosaic.Mosaic.display" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays the mosaic map as an interactive matplotlib figure.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.mosaic.Mosaic.focus">
<code class="sig-name descname">focus</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tfrecords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.mosaic.Mosaic.focus" title="Permalink to this definition">¶</a></dt>
<dd><p>Highlights certain tiles according to a focus list if list provided, or resets highlighting if no tfrecords provided.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.mosaic.Mosaic.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.mosaic.Mosaic.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the mosaic map figure to the given filename.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.mosaic.Mosaic.save_report">
<code class="sig-name descname">save_report</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.mosaic.Mosaic.save_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a report of which tiles (and their corresponding slide) were displayed on the Mosaic map, in CSV format.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="slideflow.mosaic.MosaicError">
<em class="property">exception </em><code class="sig-prename descclassname">slideflow.mosaic.</code><code class="sig-name descname">MosaicError</code><a class="headerlink" href="#slideflow.mosaic.MosaicError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-slideflow.statistics">
<span id="statistics"></span><h2>statistics<a class="headerlink" href="#module-slideflow.statistics" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt id="slideflow.statistics.StatisticsError">
<em class="property">exception </em><code class="sig-prename descclassname">slideflow.statistics.</code><code class="sig-name descname">StatisticsError</code><a class="headerlink" href="#slideflow.statistics.StatisticsError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="slideflow.statistics.TFRecordMap">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.statistics.</code><code class="sig-name descname">TFRecordMap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">slides</span></em>, <em class="sig-param"><span class="n">tfrecords</span></em>, <em class="sig-param"><span class="n">cache</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Map of tiles from TFRecords, mapped either explicitly with pre-specified coordinates, or mapped
with dimensionality reduction from penultimate layer weights, as provided from sf.activations.ActivationsVisualizer.</p>
<dl class="py method">
<dt id="slideflow.statistics.TFRecordMap.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">slides</span></em>, <em class="sig-param"><span class="n">tfrecords</span></em>, <em class="sig-param"><span class="n">cache</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Backend for mapping TFRecords into two dimensional space. Can use an ActivationsVisualizer object
to map TFRecords according to UMAP of activations, or map according to pre-specified coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slides</strong> – List of slide names</p></li>
<li><p><strong>tfrecords</strong> – List of paths to tfrecords</p></li>
<li><p><strong>cache</strong> – (optional) String, path name. If provided, will cache activations to this PKL file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.statistics.TFRecordMap.calculate_neighbors">
<code class="sig-name descname">calculate_neighbors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">slide_categories</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">algorithm</span><span class="o">=</span><span class="default_value">'kd_tree'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap.calculate_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates neighbors among tiles in this map, assigning neighboring statistics to tile metadata ‘num_unique_neighbors’ and ‘percent_matching_categories’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slide_categories</strong> – Optional, dict mapping slides to categories. If provided, will be used to calculate ‘percent_matching_categories’ statistic.</p></li>
<li><p><strong>algorithm</strong> – NearestNeighbor algorithm, either ‘kd_tree’, ‘ball_tree’, or ‘brute’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.statistics.TFRecordMap.cluster">
<code class="sig-name descname">cluster</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_clusters</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap.cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs clustering on data and adds to metadata labels. Requires an ActivationsVisualizer backend.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.statistics.TFRecordMap.export_to_csv">
<code class="sig-name descname">export_to_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap.export_to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports calculated UMAP coordinates to csv.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.statistics.TFRecordMap.filter">
<code class="sig-name descname">filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">slides</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters map to only show tiles from the given slides.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.statistics.TFRecordMap.from_activations">
<em class="property">classmethod </em><code class="sig-name descname">from_activations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">activations</span></em>, <em class="sig-param"><span class="n">exclude_slides</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">prediction_filter</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">force_recalculate</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">map_slide</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cache</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">low_memory</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">max_tiles_per_slide</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap.from_activations" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes map from an activations visualizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>activations</strong> – ActivationsVisualizer class</p></li>
<li><p><strong>exclude_slides</strong> – (optional) List of names of slides to exclude from map.</p></li>
<li><p><strong>prediction_filter</strong> – (optional) List. Will restrict predictions to only these provided categories.</p></li>
<li><p><strong>force_recalculate</strong> – (optional) Will force recalculation of umap despite presence of cache.</p></li>
<li><p><strong>use_centroid</strong> – (optional) Will calculate and map centroid activations.</p></li>
<li><p><strong>cache</strong> – (optional) String, path name. If provided, will cache umap coordinates to this PKL file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.statistics.TFRecordMap.from_precalculated">
<em class="property">classmethod </em><code class="sig-name descname">from_precalculated</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">slides</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">meta</span></em>, <em class="sig-param"><span class="n">tfrecords</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cache</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap.from_precalculated" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes map from precalculated coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slides</strong> – List of slide names</p></li>
<li><p><strong>x</strong> – X coordinates for tfrecords</p></li>
<li><p><strong>y</strong> – Y coordinates for tfrecords</p></li>
<li><p><strong>meta</strong> – List of dicts. Metadata for each point on the map (representing a single tfrecord).</p></li>
<li><p><strong>tfrecords</strong> – (optional) List of paths to tfrecords. Not required, just used to store for use by other objects. <strong>* TODO: REMOVE *</strong></p></li>
<li><p><strong>cache</strong> – (optional) String, path name. If provided, will cache umap coordinates to this PKL file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.statistics.TFRecordMap.get_tiles_in_area">
<code class="sig-name descname">get_tiles_in_area</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x_lower</span><span class="o">=</span><span class="default_value">- 999</span></em>, <em class="sig-param"><span class="n">x_upper</span><span class="o">=</span><span class="default_value">999</span></em>, <em class="sig-param"><span class="n">y_lower</span><span class="o">=</span><span class="default_value">- 999</span></em>, <em class="sig-param"><span class="n">y_upper</span><span class="o">=</span><span class="default_value">999</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap.get_tiles_in_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns dictionary of slide names mapping to tile indices, for tiles that fall within the specified location on the umap.</p>
</dd></dl>

<dl class="py method">
<dt id="slideflow.statistics.TFRecordMap.label_by_logits">
<code class="sig-name descname">label_by_logits</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap.label_by_logits" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays each point with label equal to the logits (linear from 0-1)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – Logit index</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.statistics.TFRecordMap.label_by_slide">
<code class="sig-name descname">label_by_slide</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">slide_labels</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap.label_by_slide" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays each point as the name of the corresponding slide. If slide_labels is provided, will use this dictionary to label slides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>slide_labels</strong> – (Optional) Dict mapping slide names to labels.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.statistics.TFRecordMap.label_by_tile_meta">
<code class="sig-name descname">label_by_tile_meta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tile_meta</span></em>, <em class="sig-param"><span class="n">translation_dict</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap.label_by_tile_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays each point with label equal a value in tile metadata (e.g. ‘prediction’)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile_meta</strong> – String, key to metadata from which to read</p></li>
<li><p><strong>translation_dict</strong> – Optional, if provided, will translate the read metadata through this dictionary</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.statistics.TFRecordMap.save_2d_plot">
<code class="sig-name descname">save_2d_plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">subsample</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_float</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">xlim</span><span class="o">=</span><span class="default_value">- 0.05, 1.05</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">- 0.05, 1.05</span></em>, <em class="sig-param"><span class="n">dpi</span><span class="o">=</span><span class="default_value">300</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap.save_2d_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves plot of data to a provided filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – Saves image of plot to this file.</p></li>
<li><p><strong>slide_labels</strong> – (optional) Dictionary mapping slide names to labels.</p></li>
<li><p><strong>slide_filter</strong> – (optional) List, restricts map to the provided slides.</p></li>
<li><p><strong>show_tile_meta</strong> – (optional) String (key), if provided, will label tiles according to this key as provided in the tile-level meta (self.point_meta)</p></li>
<li><p><strong>outcome_labels</strong> – (optional) Dictionary to translate outcomes (provided via show_tile_meta and point_meta) to human readable label.</p></li>
<li><p><strong>subsample</strong> – (optional) Int, if provided, will only include this number of tiles on plot (randomly selected)</p></li>
<li><p><strong>title</strong> – (optional) String, title for plot</p></li>
<li><p><strong>cmap</strong> – (optional) Dicionary mapping labels to colors</p></li>
<li><p><strong>use_float</strong> – (optional) Interpret labels as float for linear coloring</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.statistics.TFRecordMap.save_3d_node_plot">
<code class="sig-name descname">save_3d_node_plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">subsample</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap.save_3d_node_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a plot of a 3D umap, with the 3rd dimension representing values provided by argument “z”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> – Int, node to plot on 3rd axis</p></li>
<li><p><strong>filename</strong> – Filename to save image of plot</p></li>
<li><p><strong>subsample</strong> – (optionanl) int, if provided will subsample data to include only this number of tiles as maximum</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="slideflow.statistics.TFRecordMap.show_neighbors">
<code class="sig-name descname">show_neighbors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">neighbor_AV</span></em>, <em class="sig-param"><span class="n">slide</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.TFRecordMap.show_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters map to only show neighbors with a corresponding neighbor ActivationsVisualizer and neighbor slide.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neighbor_AV</strong> – ActivationsVisualizer containing activations for neighboring slide</p></li>
<li><p><strong>slide</strong> – Name of neighboring slide</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="slideflow.statistics.calculate_centroid">
<code class="sig-prename descclassname">slideflow.statistics.</code><code class="sig-name descname">calculate_centroid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">slide_node_dict</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.calculate_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Calcultes slide-level centroid indices for a provided slide-node dict.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.statistics.gen_umap">
<code class="sig-prename descclassname">slideflow.statistics.</code><code class="sig-name descname">gen_umap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array</span></em>, <em class="sig-param"><span class="n">n_components</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">n_neighbors</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">min_dist</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">metric</span><span class="o">=</span><span class="default_value">'cosine'</span></em>, <em class="sig-param"><span class="n">low_memory</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.gen_umap" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates and returns a umap from a given array.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.statistics.generate_combined_roc">
<code class="sig-prename descclassname">slideflow.statistics.</code><code class="sig-name descname">generate_combined_roc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y_true</span></em>, <em class="sig-param"><span class="n">y_pred</span></em>, <em class="sig-param"><span class="n">save_dir</span></em>, <em class="sig-param"><span class="n">labels</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'ROC'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.generate_combined_roc" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates and saves overlapping ROCs with a given combination of y_true and y_pred.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.statistics.generate_histogram">
<code class="sig-prename descclassname">slideflow.statistics.</code><code class="sig-name descname">generate_histogram</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y_true</span></em>, <em class="sig-param"><span class="n">y_pred</span></em>, <em class="sig-param"><span class="n">data_dir</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'histogram'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.generate_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates histogram of y_pred, labeled by y_true</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.statistics.generate_metrics_from_predictions">
<code class="sig-prename descclassname">slideflow.statistics.</code><code class="sig-name descname">generate_metrics_from_predictions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y_true</span></em>, <em class="sig-param"><span class="n">y_pred</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.generate_metrics_from_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates basic performance metrics, including sensitivity, specificity, and accuracy.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.statistics.generate_performance_metrics">
<code class="sig-prename descclassname">slideflow.statistics.</code><code class="sig-name descname">generate_performance_metrics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">dataset_with_slidenames</span></em>, <em class="sig-param"><span class="n">annotations</span></em>, <em class="sig-param"><span class="n">model_type</span></em>, <em class="sig-param"><span class="n">data_dir</span></em>, <em class="sig-param"><span class="n">label</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">manifest</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_tiles_per_slide</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">num_tiles</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.generate_performance_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate performance of a given model on a given TFRecord dataset,
generating a variety of statistical outcomes and graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Keras model to evaluate</strong> (<em>model</em>) – </p></li>
<li><p><strong>TFRecord dataset which include three items</strong> (<em>dataset_with_slidenames</em>) – raw image data, labels, and slide names.</p></li>
<li><p><strong>dictionary mapping slidenames to patients</strong> (<em>annotations</em>) – </p></li>
<li><p><strong>'linear'</strong><strong> or </strong><strong>'categorical'</strong> (<em>model_type</em>) – </p></li>
<li><p><strong>directory in which to save performance metrics and graphs</strong> (<em>data_dir</em>) – </p></li>
<li><p><strong>label</strong> (<em>optional</em>) – </p></li>
<li><p><strong>manifest</strong> (<em>optional</em>) – </p></li>
<li><p><strong>min_tiles_per_slide</strong> (<em>optional</em>) – </p></li>
<li><p><strong>num_tiles</strong> (<em>optional</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="slideflow.statistics.generate_roc">
<code class="sig-prename descclassname">slideflow.statistics.</code><code class="sig-name descname">generate_roc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y_true</span></em>, <em class="sig-param"><span class="n">y_pred</span></em>, <em class="sig-param"><span class="n">save_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'ROC'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.generate_roc" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates and saves an ROC with a given set of y_true, y_pred values.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.statistics.generate_scatter">
<code class="sig-prename descclassname">slideflow.statistics.</code><code class="sig-name descname">generate_scatter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y_true</span></em>, <em class="sig-param"><span class="n">y_pred</span></em>, <em class="sig-param"><span class="n">data_dir</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'_plot'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.generate_scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate and save scatter plots and calculate R2 statistic for each outcome variable.
y_true and y_pred are both 2D arrays; the first dimension is each observation, the second dimension is each outcome variable.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.statistics.get_centroid_index">
<code class="sig-prename descclassname">slideflow.statistics.</code><code class="sig-name descname">get_centroid_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_array</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.get_centroid_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate index of centroid from a given two-dimensional input array.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.statistics.normalize_layout">
<code class="sig-prename descclassname">slideflow.statistics.</code><code class="sig-name descname">normalize_layout</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">layout</span></em>, <em class="sig-param"><span class="n">min_percentile</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_percentile</span><span class="o">=</span><span class="default_value">99</span></em>, <em class="sig-param"><span class="n">relative_margin</span><span class="o">=</span><span class="default_value">0.1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.normalize_layout" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes outliers and scales layout to between [0,1].</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.statistics.read_predictions">
<code class="sig-prename descclassname">slideflow.statistics.</code><code class="sig-name descname">read_predictions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">predictions_file</span></em>, <em class="sig-param"><span class="n">level</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.read_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads predictions from a previously saved CSV file.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.statistics.to_onehot">
<code class="sig-prename descclassname">slideflow.statistics.</code><code class="sig-name descname">to_onehot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">val</span></em>, <em class="sig-param"><span class="n">num_cat</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.statistics.to_onehot" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts value to one-hot encoding</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> – Value to encode</p></li>
<li><p><strong>num_cat</strong> – Maximum value (length of onehot encoding)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-slideflow.util">
<span id="util"></span><h2>util<a class="headerlink" href="#module-slideflow.util" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="slideflow.util.ProgressBar">
<em class="property">class </em><code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">ProgressBar</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ending_val</span></em>, <em class="sig-param"><span class="n">starting_val</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">bar_length</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">endtext</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">show_eta</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_counter</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">counter_text</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">leadtext</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.ProgressBar" title="Permalink to this definition">¶</a></dt>
<dd><p>Flexible progress bar with dynamic ETA monitoring.</p>
<dl class="py method">
<dt id="slideflow.util.ProgressBar.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ending_val</span></em>, <em class="sig-param"><span class="n">starting_val</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">bar_length</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">endtext</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">show_eta</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_counter</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">counter_text</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">leadtext</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.ProgressBar.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="slideflow.util.choice_input">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">choice_input</code><span class="sig-paren">(</span><em class="sig-param">prompt</em>, <em class="sig-param">valid_choices</em>, <em class="sig-param">default=None</em>, <em class="sig-param">multi_choice=False</em>, <em class="sig-param">input_type=&lt;class 'str'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.choice_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Prompts user for multi-choice input.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.dir_input">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">dir_input</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prompt</span></em>, <em class="sig-param"><span class="n">root</span></em>, <em class="sig-param"><span class="n">default</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">create_on_invalid</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">absolute</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.dir_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Prompts user for directory input.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.file_input">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">file_input</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prompt</span></em>, <em class="sig-param"><span class="n">root</span></em>, <em class="sig-param"><span class="n">default</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filetype</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verify</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.file_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Prompts user for file input.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.float_input">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">float_input</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prompt</span></em>, <em class="sig-param"><span class="n">default</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">valid_range</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.float_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Prompts user for float input.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.get_slide_paths">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">get_slide_paths</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">slides_dir</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.get_slide_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all slide paths from a given directory containing slides.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.global_path">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">global_path</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root</span></em>, <em class="sig-param"><span class="n">path_string</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.global_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns global path from a local path.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.int_input">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">int_input</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prompt</span></em>, <em class="sig-param"><span class="n">default</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.int_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Prompts user for int input.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.load_json">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">load_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.load_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads JSON data from file.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.make_dir">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">make_dir</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">_dir</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.make_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a directory if one does not already exist, in a manner compatible with multithreading.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.path_to_ext">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">path_to_ext</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.path_to_ext" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns extension of a file path string.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.path_to_name">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">path_to_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.path_to_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns name of a file, without extension, from a given full path string.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.read_annotations">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">read_annotations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">annotations_file</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.read_annotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an annotations file.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.read_predictions_from_csv">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">read_predictions_from_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">outcome_labels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">restrict_outcomes</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outcome_type</span><span class="o">=</span><span class="default_value">'categorical'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.read_predictions_from_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to assist with loading predictions from files.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Dictionary mapping slides to nested dictionary, which maps outcome labels to predictions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.update_results_log">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">update_results_log</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">results_log_path</span></em>, <em class="sig-param"><span class="n">model_name</span></em>, <em class="sig-param"><span class="n">results_dict</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.update_results_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Dynamically update results_log when recording training metrics.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.write_json">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">write_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.write_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes data to JSON file.</p>
</dd></dl>

<dl class="py function">
<dt id="slideflow.util.yes_no_input">
<code class="sig-prename descclassname">slideflow.util.</code><code class="sig-name descname">yes_no_input</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prompt</span></em>, <em class="sig-param"><span class="n">default</span><span class="o">=</span><span class="default_value">'no'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#slideflow.util.yes_no_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Prompts user for yes/no input.</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="appendix.html" class="btn btn-neutral float-left" title="Appendix" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, James M Dolezal

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>